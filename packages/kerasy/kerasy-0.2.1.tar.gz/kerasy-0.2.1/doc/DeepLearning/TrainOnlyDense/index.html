<!DOCTYPE html>
<html class="no-js" lang="en" >
  <head>
    <link rel="shortcut icon" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" />

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Shuto" />
    <meta name="twitter:card" content="summary">
    <meta property="og:url" content="https://iwasakishuto.github.io/Kerasy/doc/DeepLearning/TrainOnlyDense/index.html" />
    <meta property="og:title" content="TrainOnlyDense">
    <meta property="og:description" content="Brief explanation of TrainOnlyDense and introduction of modules that can be used in Kerasy">
    <meta property="og:image" content="https://iwasakishuto.github.io/images/FacebookImage/Kerasy.png"/>
    <meta property="og:type" content="article" />

    <title>TrainOnlyDense - Kerasy Documentation</title>
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/custom.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/jupyter.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/theme_extra.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/theme.css">

    <script>
      // Current page data
      var mkdocs_page_name = "TrainOnlyDense";
      var mkdocs_page_input_path = "DeepLearning/TrainOnlyDense.md";
      var mkdocs_page_url = "/Kerasy/DeepLearning/TrainOnlyDense/";
    </script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/jquery-2.1.1.min.js" defer></script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/modernizr-2.8.3.min.js" defer></script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/theme.js" defer></script>

    <!-- Common CSS in my portofolio  -->
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/jupyter.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/custom.css" media="screen">
    <link rel="apple-touch-icon" sizes="152x152" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" type="image/png" />
    <!-- Use fontawesome Icon -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" rel="stylesheet" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <!-- Syntax highlight -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
    <!-- Custom CSS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        }
      });
    </script>
    <!-- Mermaid -->
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" charset="UTF-8"></script>
    <script>
      mermaid.initialize({
        startOnLoad:true
      });
    </script>
    <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
  </head>
<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Kerasy Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../..">Home</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">DeepLearning</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../CNN/">CNN</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../Optimizers/">Optimizers</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../NeuralNetwork/">Neural Network</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        TrainOnlyDense
          <span class="toctree-expand"></span>
      </a>
    </li>
    

  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../ComputationalGraph/">Computational Graph</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../Initializers/">Initializers</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">MachineLearning</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Decomposition/">Decomposition</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/sampling/">Sampling</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Linear Regression/">Linear Regression</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Cluster/">Cluster</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/HMM/">HMM</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/EM algorithm/">EM algorithm</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Tree/">Tree</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Support Vector Machine/">Support Vector Machine</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">BioInformatics</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Tandem Repeats/">Tandem Repeats</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/RefSeq/">RefSeq</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Secondary Structure/">Secondary Structure</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Alignment/">Alignment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/String Search/">String Search</a>
  </li>
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Kerasy Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>DeepLearning &raquo;</li>
        
      
    
    <li>TrainOnlyDense</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/iwasakishuto/Kerasy"> Visit github &nbsp; <i class="fab fa-github"></i></a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div id="contents">
<div class="row">
    <div class="small-12 columns article">
        <div class="topRibbon">
          <h3>TrainOnlyDense</h3>
        </div>
        <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-31(土)</span></li>
            <li><span><i class="far fa-file-code"></i>&nbsp; <a href=""></a></span></li>
            <!-- <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/deeplearning.html">DeepLearning</a></span></li> -->
        </ul>
    </div>
</div>
        <section class="article">
            <div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">kerasy.layers.convolutional</span> <span class="kn">import</span> <span class="n">Conv2D</span>
<span class="kn">from</span> <span class="nn">kerasy.layers.pool</span> <span class="kn">import</span> <span class="n">MaxPooling2D</span>
<span class="kn">from</span> <span class="nn">kerasy.layers.core</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">kerasy.engine.sequential</span> <span class="kn">import</span> <span class="n">Sequential</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cv_path</span> <span class="o">=</span> <span class="s2">"/Users/iwasakishuto/Github/portfolio/Kerasy/doc/theme/img/MNIST-sample/0.png"</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">cv_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">255</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">cv_path</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"same"</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"same"</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'tanh'</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'sgd'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">"categorical_crossentropy"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"== </span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> =="</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"output shape: </span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">output_shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"kernel shape: </span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">_losses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'kernel'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">()))</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"bias shape  : </span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">_losses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'bias'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">()))</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>      
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>== input_1 ==
output shape: (28, 28, 1)
kernel shape: ()
bias shape  : ()
== conv2d_1 ==
output shape: (28, 28, 32)
kernel shape: (3, 3, 1, 32)
bias shape  : (32,)
== conv2d_2 ==
output shape: (28, 28, 64)
kernel shape: (3, 3, 32, 64)
bias shape  : (64,)
== maxpooling2d_1 ==
output shape: (14, 14, 64)
kernel shape: ()
bias shape  : ()
== flatten_1 ==
output shape: (12544,)
kernel shape: ()
bias shape  : ()
== dense_1 ==
output shape: (128,)
kernel shape: (128, 12544)
bias shape  : (128, 1)
== dense_2 ==
output shape: (10,)
kernel shape: (10, 128)
bias shape  : (10, 1)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#=== Train Only Dense Layer ===</span>
<span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># #=== Train Only Convolutional Layer ===</span>
<span class="c1"># model.layers[-1].trainable = False</span>
<span class="c1"># model.layers[-2].trainable = False</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">original_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"original prediction: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">original_pred</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">original_pred</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>original prediction: 2
[[0.09963766 0.1004707  0.10146399 0.09917924 0.10046313 0.0988132
  0.09983802 0.10139949 0.10078803 0.09794654]]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ans_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">original_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ans_label: </span><span class="si">{</span><span class="n">ans_label</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>ans_label: 9
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,))</span>
<span class="n">y_true</span><span class="p">[</span><span class="n">ans_label</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1/30]
[2/30]
[3/30]
[4/30]
[5/30]
[6/30]
[7/30]
[8/30]
[9/30]
[10/30]
[11/30]
[12/30]
[13/30]
[14/30]
[15/30]
[16/30]
[17/30]
[18/30]
[19/30]
[20/30]
[21/30]
[22/30]
[23/30]
[24/30]
[25/30]
[26/30]
[27/30]
[28/30]
[29/30]
[30/30]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">final_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Answer: </span><span class="si">{</span><span class="n">ans_label</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  original prediction: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">original_pred</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">original_pred</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  final prediction: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">final_pred</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">final_pred</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Difference:</span><span class="se">\n</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">final_pred</span><span class="o">-</span><span class="n">original_pred</span><span class="p">)</span><span class="o">></span><span class="mi">0</span><span class="p">,</span> <span class="s1">'+'</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>  Answer: 9
  original prediction: 2
[[0.09963766 0.1004707  0.10146399 0.09917924 0.10046313 0.0988132
  0.09983802 0.10139949 0.10078803 0.09794654]]
  final prediction: 9
[[0.00293264 0.002827   0.00315045 0.00266858 0.00292554 0.00257199
  0.00294734 0.00316633 0.00319796 0.97361218]]
  Difference:
[['-' '-' '-' '-' '-' '-' '-' '-' '-' '+']]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">Functions.TexWriter</span> <span class="kn">import</span> <span class="n">CNNbackprop2tex</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kh</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sh</span><span class="p">,</span> <span class="n">sw</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">IH</span><span class="p">,</span> <span class="n">IW</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">OH</span><span class="p">,</span> <span class="n">OW</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CNNbackprop2tex</span><span class="p">(</span><span class="n">IH</span><span class="p">,</span><span class="n">IW</span><span class="p">,</span><span class="n">OH</span><span class="p">,</span><span class="n">OW</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">kw</span><span class="p">,</span><span class="n">sh</span><span class="p">,</span><span class="n">sw</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">"sample.tex"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Your tex file saved at '/Users/iwasakishuto/Github/portfolio/Kerasy/pelican/pelican-src/DeepLearning/sample.tex'
Please run the following code. Then, /Users/iwasakishuto/Github/portfolio/Kerasy/pelican/pelican-src/DeepLearning/sample.pdf will be created.
==============================
$ platex /Users/iwasakishuto/Github/portfolio/Kerasy/pelican/pelican-src/DeepLearning/sample.tex
$ dvipdfmx /Users/iwasakishuto/Github/portfolio/Kerasy/pelican/pelican-src/DeepLearning/sample.dvi
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span>! platex /Users/iwasakishuto/Github/portfolio/Kerasy/pelican/pelican-src/DeepLearning/sample.tex
! dvipdfmx /Users/iwasakishuto/Github/portfolio/Kerasy/pelican/pelican-src/DeepLearning/sample.dvi
</pre></div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

        </section>
    </div>
</div>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ComputationalGraph/" class="btn btn-neutral float-right" title="Computational Graph">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../NeuralNetwork/" class="btn btn-neutral" title="Neural Network"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../NeuralNetwork/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ComputationalGraph/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
