<!DOCTYPE html>
<html class="no-js" lang="en" >
  <head>
    <link rel="shortcut icon" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" />

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Shuto" />
    <meta name="twitter:card" content="summary">
    <meta property="og:url" content="https://iwasakishuto.github.io/Kerasy/doc/DeepLearning/NeuralNetwork/index.html" />
    <meta property="og:title" content="NeuralNetwork">
    <meta property="og:description" content="Brief explanation of NeuralNetwork and introduction of modules that can be used in Kerasy">
    <meta property="og:image" content="https://iwasakishuto.github.io/images/FacebookImage/Kerasy.png"/>
    <meta property="og:type" content="article" />

    <title>NeuralNetwork - Kerasy Documentation</title>
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/custom.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/jupyter.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/theme_extra.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/theme.css">

    <script>
      // Current page data
      var mkdocs_page_name = "NeuralNetwork";
      var mkdocs_page_input_path = "DeepLearning/NeuralNetwork.md";
      var mkdocs_page_url = "/Kerasy/DeepLearning/NeuralNetwork/";
    </script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/jquery-2.1.1.min.js" defer></script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/modernizr-2.8.3.min.js" defer></script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/theme.js" defer></script>

    <!-- Common CSS in my portofolio  -->
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/jupyter.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/custom.css" media="screen">
    <link rel="apple-touch-icon" sizes="152x152" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" type="image/png" />
    <!-- Use fontawesome Icon -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" rel="stylesheet" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <!-- Syntax highlight -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
    <!-- Custom CSS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        }
      });
    </script>
    <!-- Mermaid -->
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" charset="UTF-8"></script>
    <script>
      mermaid.initialize({
        startOnLoad:true
      });
    </script>
    <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
  </head>
<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Kerasy Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../..">Home</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">DeepLearning</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../CNN/">CNN</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../Optimizers/">Optimizers</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Neural Network
          <span class="toctree-expand"></span>
      </a>
    </li>
    

  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../TrainOnlyDense/">TrainOnlyDense</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../ComputationalGraph/">Computational Graph</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../Initializers/">Initializers</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">MachineLearning</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Decomposition/">Decomposition</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/sampling/">Sampling</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Linear Regression/">Linear Regression</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Cluster/">Cluster</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/HMM/">HMM</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/EM algorithm/">EM algorithm</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Tree/">Tree</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Support Vector Machine/">Support Vector Machine</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">BioInformatics</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Tandem Repeats/">Tandem Repeats</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/RefSeq/">RefSeq</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Secondary Structure/">Secondary Structure</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Alignment/">Alignment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/String Search/">String Search</a>
  </li>
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Kerasy Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>DeepLearning &raquo;</li>
        
      
    
    <li>Neural Network</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/iwasakishuto/Kerasy"> Visit github &nbsp; <i class="fab fa-github"></i></a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div id="contents">
<div class="row">
    <div class="small-12 columns article">
        <div class="topRibbon">
          <h3>Neural Network</h3>
        </div>
        <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-18(日)</span></li>
            <li><span><i class="far fa-file-code"></i>&nbsp; <a href=""></a></span></li>
            <!-- <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/deeplearning.html">DeepLearning</a></span></li> -->
        </ul>
    </div>
</div>
        <section class="article">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Neural-Network">Neural Network<a class="anchor-link" href="#Neural-Network">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Table-of-contents">Table of contents<a class="anchor-link" href="#Table-of-contents">¶</a></h2><ol>
<li><a data-scroll="" href="#anchor1">単純パーセプロトン (Perceptron)</a></li>
<li><a data-scroll="" href="#anchor2">多層パーセプロトン (Multilayer Perceptron)</a></li>
<li><a data-scroll="" href="#anchor3">誤差逆伝播法 (Back Propagation)</a></li>
<li><a data-scroll="" href="#anchor4">実装 (Implementation)</a></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor1">1. 単純パーセプロトン (Perceptron)</h2><p>ニューラルネットワークは <strong>多数の素子（パーセプトロン）の集まり</strong> で表現されます。そこで、まずは１つ１つの素子、パーセプロトンを見ていきます。</p>
<p>単一の素子は以下の図のように表され、入力を受け取り、</p>
<ul>
<li><strong>その値（の和）がある閾値 $\theta$ を超えたら発火して出力</strong></li>
<li><strong>$\theta$ 以下だったら出力しない</strong></li>
</ul>
<p>という性質を持ちます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="Perceptron" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/NeuralNetworks/Perceptron.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>この性質を数学的に記述すると、</p>
<ul>
<li>重みパラメータ：$w_0,w_1,\ldots,w_m$</li>
<li>活性化関数：$h$</li>
</ul>
<p>から構成される以下のような関数として書けます。</p>
$$f(x_1,x_2,\ldots,x_m) = h(w_1x_1+w_2x_2+\cdots+w_Nx_N+w_0)$$<p>この時 $w_0$ は<font color="red"><b>バイアスパラメータ(bias parameter)</b></font>と呼ばれ、<b>関数を平行移動させる</b>役割を果たします。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="活性化関数(activation-function)">活性化関数(activation function)<a class="anchor-link" href="#活性化関数(activation-function)">¶</a></h3><p>活性化関数は、<font color="red"><b>「ある閾値 $\theta$ を超えたら発火して出力し、$\theta$ 以下だったら出力しない」</b></font>という神経の性質を表現するための関数であり、最も単純なものとしては以下で表される<b>ヘヴィサイド関数(Heaviside function)</b>があります。</p>
$$h(a) = \left\{\begin{array}{cc}0 & (\theta < 0) \\1 & (\theta > 0)\end{array}\right.$$<p>この性質は表したい能力を如実に表してはいますが、<b>不連続であり扱いづらい</b>ため、実際は</p>
<ul>
<li><b>ロジスティックシグモイド関数</b>：
$$h(a) = \frac{1}{1+\exp(-a)}\qquad(4.59)$$</li>
<li><b>ハイパボリックタンジェント関数</b>：
$$\begin{aligned}h(a) &= \tanh (a)\\&=\frac{e^a-e^{-1}}{e^1+e^{-1}}
&(5.59)\end{aligned}$$</li>
<li><b>ソフトマックス関数</b>：
$$h(\mathbf{a}) = \frac{\exp(a_i)}{\sum_j \exp(a_i)}\qquad (4.63)$$</li>
</ul>
<p>などが用いられることが多いです。</p>
<p>※ Kerasyでは<a href="https://github.com/iwasakishuto/Kerasy/blob/gh-pages/kerasy/activations.py">ここ</a>で定義しています。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Linear</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">input</span>

    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">dhda</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">dhda</span> 

<span class="k">class</span> <span class="nc">Tanh</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">dhda</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">dhda</span>

<span class="n">ActivationHandler</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'linear'</span> <span class="p">:</span> <span class="n">Linear</span><span class="p">,</span>
    <span class="s1">'tanh'</span>   <span class="p">:</span> <span class="n">Tanh</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">ActivationFunc</span><span class="p">(</span><span class="n">activation_func_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ActivationHandler</span><span class="p">[</span><span class="n">activation_func_name</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor2">2. 多層パーセプロトン (Multilayer Perceptron)</h2><p>それでは、複数の単子（単純パーセプロトン）を繋げて２層のパーセプトロンを作ります。なお、<b>２層以上のパーセプトロンを<font color="red">ニューラルネットワーク</font></b>と言います。</p>
<p>例えば１層目に $m$ 個の素子を用意し、入力が $D$ 次元の場合、関数で表すと</p>
$$y = h_2\left(\sum_{i=0}^{m} w^{(2)}_ih_1\left(\sum_{j=0}^{D}w^{(1)}_{ij} x_j\right)\right)\qquad(5.9)$$<p>となります。</p>
<p><img alt="Multilayer Perceptron" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/NeuralNetworks/Multilayer-Perceptron.png" /></p>
<table>
<thead><tr>
<th style="text-align:center">記号</th>
<th style="text-align:left">意味</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$w^{(1)}_{ij}$</td>
<td style="text-align:left">$1$ 層目の $i$ 番目の素子への入力 $x_j$ の重み</td>
</tr>
<tr>
<td style="text-align:center">$w^{(2)}_i$</td>
<td style="text-align:left">$1$ 層目の $i$ 番目の素子から $2$ 層目の素子への入力の重み</td>
</tr>
<tr>
<td style="text-align:center">$h_1,h_2$</td>
<td style="text-align:left">それぞれの層の活性化関数</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="多層にする意味">多層にする意味<a class="anchor-link" href="#多層にする意味">¶</a></h3><ul>
<li>単純パーセプロトン：
$$ y=f\left(\sum_i w_i\textcolor{red}{\phi_i(\mathbf{x})}\right) \qquad(5.1)$$</li>
<li>$2$ 層パーセプトロン：
$$ y = h_2\left(\sum_{i=0}^{m} w^{(2)}_i\textcolor{red}{h_1\left(\sum_{j=0}^{D}w^{(1)}_{ij} x_j\right)}\right)\qquad(5.9)$$</li>
</ul>
<p>この式から分かるように、基底 $\phi_i(\mathbf{x})$ が $\displaystyle h_1\left(\sum_{j=0}^{D}w^{(1)}_{ij} x_j\right)$ に置き換わっていることがわかります。</p>
<p>これによって、<font color="red"><b>単一だと「固定」されていた基底関数が、多層になることで「適応的に変動」する</b></font>ようになります。ゆえに、<b>十分大きな $m$ をとり、活性化関数が非線形な多層パーセプトロンは、<font color="red">任意の関数を任意の精度で近似することができる</font></b>という性質を持ちます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor3">3. 誤差逆伝播法 (Back Propagation)</h2><p>ニューラルネットワークについて語る上で避けては通れなく、理解が難しいのが<font color="red"><b>誤差逆伝播法（back propagation）</b></font>です。</p>
<p>しかし、誤差逆伝播法とは<b>「ニューラルネットワークを学習させる際に用いられる効率的な計算方法」</b>のことで、簡単に言ってしまえば<font color="red"><b>「合成関数の微分則」</b></font>です。また、ネットワークの訓練とは、<b>「（重みを変化させることで）訓練データの出力と正解の誤差 $E_n(\mathbf{w})$ を最小化すること」</b>を指します。</p>
<p>以下、</p>
<ul>
<li>素子 $i$ の出力を $z_i$</li>
<li>素子 $j$ への入力和を $a_j$</li>
</ul>
<p>として、説明します。</p>
<p>したがって、学習のプロセスにおいては<b>「素子 $i$ から素子 $j$ への接続の重み $w_{ji}$ として、全ての $i,j$ の組合せ（＝全ノードの重み）に対して$ \frac{\partial E_n}{\partial w_{ji}} $を計算すること」</b>が目標となります。</p>
<p><img alt="Back Propagation" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/NeuralNetworks/BackPropagation1.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>すると、上の図のように<b>「$E_n$ は $a_j$ を介してのみ $w_{ji}$ に依存する」（＝ $w_{ji}$ が変化すると $a_j$ が変化し、それが $E_n$ に影響を及ぼす）</b>ことに注意すれば</p>
$$ \frac{\partial E_n}{\partial w_{ji}} = \frac{\partial E_n}{\partial a_j}\frac{\partial a_j}{\partial w_{ji}}\qquad(5.50)$$<p>となります。また、ここで $\delta_j = \partial E_n/\partial a_j$ と書くことにし、これを<font color="red"><b>誤差</b></font>と呼びます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="Back Propagation2" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/NeuralNetworks/BackPropagation2.png" /></p>
<p>続いて、$\delta_i$ について考えると、$E_n$ は素子 $i$ の出力を受け取る素子 $j$ の入力 $a_j$ を介して $a_i$ に依存するので、合成微分則より</p>
$$ \delta_i = \frac{\partial E_n}{\partial a_i} = \sum_j \frac{\partial E_n}{\partial a_j}\frac{\partial a_j}{\partial a_i} = \sum_j\delta_j\frac{\partial a_j}{\partial a_i}\qquad(5.55)$$<p>となります。（下図参照）</p>
<p><img alt="Back Propagation3" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/NeuralNetworks/BackPropagation3.png" /></p>
<p>さらに、素子 $i$ の活性化関数を $h_i$ とすると、</p>
$$a_j = \sum_i w_{ji} h_i(a_i)\qquad(5.48)$$<p>だった（素子 $i$ への入力和を活性化関数に通しそれぞれに重み $w_{ji}$ をかけた和を素子 $j$ に伝える）ので、</p>
$$ \frac{\partial a_j}{\partial a_i} = w_{ji} h_i'(a_i)$$<p>となります。</p>
<p><img alt="Back Propagation4" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/NeuralNetworks/BackPropagation4.png" /></p>
<p>ここまでをまとめると、誤差 $\delta_i$ の逆伝播公式</p>
$$ \delta_i = h_i'(a_i) \sum_j w_{ji}\delta_j\qquad(5.56)$$<p>が得られます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>また、ネットワークの出力部における $\delta$ の値は直接計算する事が出来るので、そこから逆にネットワークを辿りながら各 $\delta$ を計算する事が可能になります。</p>
<p>このネットワークを逆に辿る過程で各 $w_{ji}$ に対する $W$ 個の偏導関数を一回の誤差伝播で求めてしまう事が出来るので、<b>効率の良いアルゴリズム</b>となっています。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="【まとめ】">【まとめ】<a class="anchor-link" href="#【まとめ】">¶</a></h3><ol>
<li>データ $\mathbf{x}_n$ を入力した時の、各素子への入力 $a_i$ 出力 $z_i$ を求める。<b>（順伝播）</b></li>
<li>ネットワークの出力部における誤差 $\delta_i$ を計算する。</li>
<li>逆伝播公式を利用して各素子における $\delta_i$ を計算する。
$$\delta_i = h_i'(a_i) \sum_j w_{ji}\delta_j$$</li>
<li>以下を利用して必要な偏微分係数を求める。
$$\frac{\partial E_n}{\partial w_{ji}} = \delta_j z_i$$</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor4">4. 実装 (Implementation)</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="初期化">初期化<a class="anchor-link" href="#初期化">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">Zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RandomNormal</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>

<span class="n">InitializeHandler</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'zeros'</span><span class="p">:</span> <span class="n">Zeros</span><span class="p">,</span>
    <span class="s1">'random_normal'</span><span class="p">:</span> <span class="n">RandomNormal</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">Initializer</span><span class="p">(</span><span class="n">initializer_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">InitializeHandler</span><span class="p">[</span><span class="n">initializer_name</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="誤差関数">誤差関数<a class="anchor-link" href="#誤差関数">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">mean_squared_error</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_true</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">y_pred</span><span class="o">-</span><span class="n">y_true</span>

<span class="n">LossHandler</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'mean_squared_error'</span> <span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">LossFunc</span><span class="p">(</span><span class="n">loss_func_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">LossHandler</span><span class="p">[</span><span class="n">loss_func_name</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="各層">各層<a class="anchor-link" href="#各層">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Layers</span><span class="p">():</span>
    <span class="n">NLayers</span><span class="o">=</span><span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Layer</span><span class="si">{</span><span class="n">Layers</span><span class="o">.</span><span class="n">NLayers</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outdim</span><span class="o">=</span><span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Layers</span><span class="o">.</span><span class="n">NLayers</span><span class="o">+=</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indim</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indim</span> <span class="o">=</span> <span class="n">indim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">indim</span><span class="p">)),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdim</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="p">]</span>

<span class="k">class</span> <span class="nc">Input</span><span class="p">(</span><span class="n">Layers</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputdim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">"inputs"</span><span class="p">,</span> <span class="n">inputdim</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Dense</span><span class="p">(</span><span class="n">Layers</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">'random_normal'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s1">'zeros'</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        @param units             : (tuple) dimensionality of the (input space, output space).</span>
<span class="sd">        @param activation        : (str) Activation function to use.</span>
<span class="sd">        @param kernel_initializer: (str) Initializer for the `kernel` weights matrix.</span>
<span class="sd">        @param bias_initializer  : (str) Initializer for the bias vector.</span>
<span class="sd">        """</span>        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">"dense"</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">Initializer</span><span class="p">(</span><span class="n">kernel_initializer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span>   <span class="o">=</span> <span class="n">Initializer</span><span class="p">(</span><span class="n">bias_initializer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">ActivationFunc</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
        <span class="sd">""" @param input: shape=(Din,) """</span>
        <span class="n">z_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># shape=(Din+1,)            </span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">z_in</span><span class="p">)</span>      <span class="c1"># (Dout,Din+1) @ (Din+1,) = (Dout,)</span>
        <span class="n">z_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># shape=(Dout,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">z_out</span>

    <span class="k">def</span> <span class="nf">backprop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dEdz_out</span><span class="p">):</span>
        <span class="sd">""" @param dEdz_out: shape=(Dout,) """</span>
        <span class="n">dEda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">dEdz_out</span> <span class="c1"># δ, shape=(Dout,)</span>
        <span class="n">dEdz_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dEda</span><span class="p">)</span>        <span class="c1"># (Din+1,Dout) @ (Dout,) = (Din+1,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dEda</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dEdz_in</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                 <span class="c1"># shape=(Din,) term of bias is not propagated.</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">ALPHA</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
        <span class="sd">""" @param delta: shape=(Dout,) """</span>
        <span class="n">dw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="c1"># (Dout,) × (Din+1,) = (Dout,Din+1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-=</span> <span class="n">ALPHA</span><span class="o">*</span><span class="n">dw</span> <span class="c1"># update. w → w + ALPHA*dw</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="モデル（各層のスタック）">モデル（各層のスタック）<a class="anchor-link" href="#モデル（各層のスタック）">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Sequential</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
        <span class="sd">"""Adds a layer instance."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">""" Creates the layer weights. """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="n">LossFunc</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
        <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">outdim</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"inputs"</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">l</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">indim</span><span class="o">=</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">goal_epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">+</span><span class="n">epochs</span>
        <span class="n">digit</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">goal_epochs</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
            <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_pred</span><span class="o">-</span><span class="n">y_train</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">99</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">+</span><span class="mi">1</span><span class="si">:{</span><span class="n">digit</span><span class="si">}</span><span class="s1">d</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">goal_epochs</span><span class="si">:{</span><span class="n">digit</span><span class="si">}</span><span class="s1">d</span><span class="si">}</span><span class="s1">] mse=</span><span class="si">{</span><span class="n">mse</span><span class="si">:{</span><span class="mi">4</span><span class="si">}</span><span class="s1">f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
        <span class="n">out</span><span class="o">=</span><span class="nb">input</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"inputs"</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">out</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>            
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="nf">backprop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
        <span class="n">dEdz_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"inputs"</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">dEdz_out</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">dEdz_out</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_train</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="実装例">実装例<a class="anchor-link" href="#実装例">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"tanh"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">"random_normal"</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">"zeros"</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"tanh"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">"random_normal"</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">"zeros"</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"tanh"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Units:   </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">outdim</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Layers:  </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Weights: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">w</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">"mean_squared_error"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Weights: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">w</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Units:   [1, 3, 3, 1]
Layers:  ['Layer1.inputs', 'Layer2.dense', 'Layer3.dense', 'Layer4.dense']
Weights: [None, None, None, None]
Weights: [None, (3, 2), (3, 4), (1, 4)]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 100/1000] mse=0.027993
[ 200/1000] mse=0.007164
[ 300/1000] mse=0.001297
[ 400/1000] mse=0.000846
[ 500/1000] mse=0.000842
[ 600/1000] mse=0.000807
[ 700/1000] mse=0.000766
[ 800/1000] mse=0.000728
[ 900/1000] mse=0.000694
[1000/1000] mse=0.000664
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Neural Network"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"data"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<style>
/*蛍光ペン(pink)*/
.marker-pink {
  color: #c45a5a;
  background: linear-gradient(transparent 70%, #ff66ff 60%);
  font-weight: bold;
}
/*蛍光ペン(blue) & hover info*/
.marker-info {
    color: #5C7DC4;
    background: linear-gradient(transparent 70%, #66FFCC 60%);
    font-weight: bold;
    position: relative;
    cursor: pointer;
}
.marker-info:hover:before {
    opacity: 1;
}
.marker-info:before {
  content: attr(aria-label);
  opacity: 0;
  position: absolute;
  top: 30px;
  right: -90px;
  font-size: 14px;
  width: 300px;
  padding: 10px;
  color: #fff;
  background-color: #555;
  border-radius: 3px;
  pointer-events: none;
}
</style>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

        </section>
    </div>
</div>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../TrainOnlyDense/" class="btn btn-neutral float-right" title="TrainOnlyDense">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Optimizers/" class="btn btn-neutral" title="Optimizers"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Optimizers/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../TrainOnlyDense/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
