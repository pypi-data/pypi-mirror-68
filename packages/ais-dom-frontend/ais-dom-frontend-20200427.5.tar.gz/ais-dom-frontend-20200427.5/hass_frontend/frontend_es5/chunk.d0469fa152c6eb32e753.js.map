{"version":3,"sources":["webpack:///./src/components/dialog/ha-iron-focusables-helper.js","webpack:///./src/components/dialog/ha-paper-dialog.ts","webpack:///./src/panels/aisgalery/ha-dialog-aisgalery.ts"],"names":["HaIronFocusablesHelper","getTabbableNodes","node","result","this","_collectTabbableNodes","IronFocusablesHelper","_sortByTabIndex","nodeType","Node","ELEMENT_NODE","_isVisible","children","element","tabIndex","_normalizedTabIndex","needsSort","push","localName","dom","getDistributedNodes","shadowRoot","root","i","length","paperDialogClass","customElements","get","haTabFixBehaviorImpl","_focusableNodes","HaPaperDialog","_mixinBehaviors","_inherits","mixinBehaviors","_super","_createSuper","_classCallCheck","apply","arguments","define","HaDialogAisgalery","_decorate","customElement","_initialize","_LitElement","_LitElement2","_this","call","_assertThisInitialized","loadVaadin","F","d","kind","static","key","value","haStyleDialog","css","_templateObject","decorators","property","_showDialog","_asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","_opened","stop","html","_templateObject2","_openedChanged","_loadVaadin","_callee3","_this2","_context3","whenDefined","then","_callee2","upload","tokens","_context2","querySelector","loadTokens","set","authorization","access_token","addEventListener","event","console","log","detail","file","name","error","changedProps","_get","_getPrototypeOf","prototype","ev","LitElement"],"mappings":"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","file":"chunk.d0469fa152c6eb32e753.js","sourcesContent":["/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n/*\n  Fixes issue with not using shadow dom properly in iron-overlay-behavior/icon-focusables-helper.js\n*/\nimport { IronFocusablesHelper } from \"@polymer/iron-overlay-behavior/iron-focusables-helper\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom\";\n\nexport const HaIronFocusablesHelper = {\n  /**\n   * Returns a sorted array of tabbable nodes, including the root node.\n   * It searches the tabbable nodes in the light and shadow dom of the chidren,\n   * sorting the result by tabindex.\n   * @param {!Node} node\n   * @return {!Array<!HTMLElement>}\n   */\n  getTabbableNodes: function (node) {\n    var result = [];\n    // If there is at least one element with tabindex > 0, we need to sort\n    // the final array by tabindex.\n    var needsSortByTabIndex = this._collectTabbableNodes(node, result);\n    if (needsSortByTabIndex) {\n      return IronFocusablesHelper._sortByTabIndex(result);\n    }\n    return result;\n  },\n\n  /**\n   * Searches for nodes that are tabbable and adds them to the `result` array.\n   * Returns if the `result` array needs to be sorted by tabindex.\n   * @param {!Node} node The starting point for the search; added to `result`\n   * if tabbable.\n   * @param {!Array<!HTMLElement>} result\n   * @return {boolean}\n   * @private\n   */\n  _collectTabbableNodes: function (node, result) {\n    // If not an element or not visible, no need to explore children.\n    if (\n      node.nodeType !== Node.ELEMENT_NODE ||\n      !IronFocusablesHelper._isVisible(node)\n    ) {\n      return false;\n    }\n    var element = /** @type {!HTMLElement} */ (node);\n    var tabIndex = IronFocusablesHelper._normalizedTabIndex(element);\n    var needsSort = tabIndex > 0;\n    if (tabIndex >= 0) {\n      result.push(element);\n    }\n\n    // In ShadowDOM v1, tab order is affected by the order of distrubution.\n    // E.g. getTabbableNodes(#root) in ShadowDOM v1 should return [#A, #B];\n    // in ShadowDOM v0 tab order is not affected by the distrubution order,\n    // in fact getTabbableNodes(#root) returns [#B, #A].\n    //  <div id=\"root\">\n    //   <!-- shadow -->\n    //     <slot name=\"a\">\n    //     <slot name=\"b\">\n    //   <!-- /shadow -->\n    //   <input id=\"A\" slot=\"a\">\n    //   <input id=\"B\" slot=\"b\" tabindex=\"1\">\n    //  </div>\n    // TODO(valdrin) support ShadowDOM v1 when upgrading to Polymer v2.0.\n    var children;\n    if (element.localName === \"content\" || element.localName === \"slot\") {\n      children = dom(element).getDistributedNodes();\n    } else {\n      // /////////////////////////\n      // Use shadow root if possible, will check for distributed nodes.\n      // THIS IS THE CHANGED LINE\n      children = dom(element.shadowRoot || element.root || element).children;\n      // /////////////////////////\n    }\n    for (var i = 0; i < children.length; i++) {\n      // Ensure method is always invoked to collect tabbable children.\n      needsSort = this._collectTabbableNodes(children[i], result) || needsSort;\n    }\n    return needsSort;\n  },\n};\n","import \"@polymer/paper-dialog/paper-dialog\";\nimport type { PaperDialogElement } from \"@polymer/paper-dialog/paper-dialog\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class\";\nimport type { Constructor } from \"../../types\";\nimport { HaIronFocusablesHelper } from \"./ha-iron-focusables-helper\";\n\nconst paperDialogClass = customElements.get(\"paper-dialog\") as Constructor<\n  PaperDialogElement\n>;\n\n// behavior that will override existing iron-overlay-behavior and call the fixed implementation\nconst haTabFixBehaviorImpl = {\n  get _focusableNodes() {\n    return HaIronFocusablesHelper.getTabbableNodes(this);\n  },\n};\n\n// paper-dialog that uses the haTabFixBehaviorImpl behvaior\n// export class HaPaperDialog extends paperDialogClass {}\n// @ts-ignore\nexport class HaPaperDialog\n  extends mixinBehaviors([haTabFixBehaviorImpl], paperDialogClass)\n  implements PaperDialogElement {}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dialog\": HaPaperDialog;\n  }\n}\n// @ts-ignore\ncustomElements.define(\"ha-paper-dialog\", HaPaperDialog);\n","import \"@polymer/iron-icon/iron-icon\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"../../components/dialog/ha-paper-dialog\";\nimport \"@vaadin/vaadin-upload\";\nimport { loadTokens } from \"../../../src/common/auth/token_storage\";\nimport {\n  LitElement,\n  html,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit-element\";\nimport { HomeAssistant } from \"../../types\";\nimport { haStyleDialog } from \"../../resources/styles\";\n\n@customElement(\"ha-dialog-aisgalery\")\nexport class HaDialogAisgalery extends LitElement {\n  static get styles(): CSSResult[] {\n    return [\n      haStyleDialog,\n      css`\n        :host {\n          z-index: 103;\n        }\n\n        paper-icon-button {\n          color: var(--secondary-text-color);\n        }\n\n        paper-icon-button[active] {\n          color: var(--primary-color);\n        }\n\n        ha-paper-dialog {\n          width: 450px;\n          height: 350px;\n        }\n        a.button {\n          text-decoration: none;\n        }\n        a.button > mwc-button {\n          width: 100%;\n        }\n        .onboarding {\n          padding: 0 24px;\n        }\n        paper-dialog-scrollable.top-border::before {\n          content: \"\";\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 1px;\n          background: var(--divider-color);\n        }\n      `,\n    ];\n  }\n  @property() public hass!: HomeAssistant;\n  @property() private _opened = false;\n\n  constructor() {\n    super();\n    this.loadVaadin();\n  }\n\n  public async showDialog(): Promise<void> {\n    this._opened = true;\n    this.loadVaadin();\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <style>\n        paper-dialog-scrollable {\n          --paper-dialog-scrollable: {\n            -webkit-overflow-scrolling: auto;\n            max-height: 50vh !important;\n          }\n        }\n\n        paper-dialog-scrollable.can-scroll {\n          --paper-dialog-scrollable: {\n            -webkit-overflow-scrolling: touch;\n            max-height: 50vh !important;\n          }\n        }\n\n        @media all and (max-width: 450px), all and (max-height: 500px) {\n          paper-dialog-scrollable {\n            --paper-dialog-scrollable: {\n              -webkit-overflow-scrolling: auto;\n              max-height: calc(100vh - 175px) !important;\n            }\n          }\n\n          paper-dialog-scrollable.can-scroll {\n            --paper-dialog-scrollable: {\n              -webkit-overflow-scrolling: touch;\n              max-height: calc(75vh - 175px) !important;\n            }\n          }\n        }\n        app-toolbar {\n          margin: 0;\n          padding: 0 16px;\n          color: var(--primary-text-color);\n          background-color: var(--secondary-background-color);\n        }\n        app-toolbar [main-title] {\n          margin-left: 16px;\n        }\n      </style>\n      <dom-module id=\"my-button\" theme-for=\"vaadin-button\">\n        <template>\n          <style>\n            :host {\n              color: var(--primary-color);\n              border: 1px solid;\n            }\n          </style>\n        </template>\n      </dom-module>\n      <ha-paper-dialog\n        with-backdrop\n        .opened=${this._opened}\n        @opened-changed=${this._openedChanged}\n      >\n        <app-toolbar>\n          <paper-icon-button\n            icon=\"hass:close\"\n            dialog-dismiss=\"\"\n          ></paper-icon-button>\n          <div main-title=\"\">Dodawanie zdjęć</div>\n        </app-toolbar>\n        <vaadin-upload\n          capture=\"camera\"\n          accept=\"image/*\"\n          noAuto=\"false\"\n          style=\"text-align: center;\"\n        >\n          <span slot=\"drop-label\" style=\"color:white;\"\n            >Możesz przeciągnąć i upuścić tu.</span\n          >\n        </vaadin-upload>\n      </ha-paper-dialog>\n    `;\n  }\n\n  protected async loadVaadin() {\n    customElements.whenDefined(\"vaadin-upload\").then(async () => {\n      const upload = this.shadowRoot!.querySelector(\"vaadin-upload\");\n      const tokens = loadTokens();\n      if (upload !== null) {\n        upload.set(\"i18n.addFiles.many\", \"Wyślij zdjęcie [plik 5MB max] ...\");\n        upload.set(\n          \"i18n.fileIsTooBig\",\n          \"Plik jest za duży. Maksymalnie można przesłać 5MB\"\n        );\n        upload.set(\"method\", \"POST\");\n        upload.set(\"withCredentials\", true);\n        upload.set(\"target\", \"api/ais_file/upload\");\n        upload.set(\"headers\", {\n          authorization: \"Bearer \" + tokens.access_token,\n        });\n        upload.addEventListener(\"file-reject\", function(event) {\n          console.log(event.detail.file.name + \" error: \" + event.detail.error);\n        });\n      }\n    });\n  }\n\n  protected firstUpdated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n  }\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n  }\n\n  private _openedChanged(ev: CustomEvent) {\n    this._opened = ev.detail.value;\n    this.loadVaadin();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-dialog-aisgalery\": HaDialogAisgalery;\n  }\n}\n"],"sourceRoot":""}