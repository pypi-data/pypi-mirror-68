{"version":3,"sources":["webpack:///./src/common/navigate.ts","webpack:///./src/common/string/compare.ts","webpack:///./src/common/util/render-status.ts","webpack:///./src/data/integration.ts","webpack:///./src/data/config_flow.ts","webpack:///./src/dialogs/config-flow/show-dialog-data-entry-flow.ts","webpack:///./src/dialogs/config-flow/show-dialog-config-flow.ts","webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/data/zone.ts","webpack:///./src/data/core.ts","webpack:///./src/components/map/ha-location-editor.ts","webpack:///./src/components/timezone-datalist.ts","webpack:///./src/onboarding/onboarding-core-config.ts"],"names":["__webpack_require__","d","__webpack_exports__","navigate","_dom_fire_event__WEBPACK_IMPORTED_MODULE_0__","_node","path","replace","history","replaceState","pushState","fireEvent","window","compare","caseInsensitiveCompare","a","b","toLowerCase","afterNextRender","nextRender","cb","requestAnimationFrame","setTimeout","Promise","resolve","integrationIssuesUrl","domainToName","fetchIntegrationManifests","fetchIntegrationManifest","domain","getIntegrationIssuesUrl","localize","hass","callWS","type","integration","DISCOVERY_SOURCES","createConfigFlow","fetchConfigFlow","handleConfigFlowStep","ignoreConfigFlow","deleteConfigFlow","getConfigFlowHandlers","getConfigFlowInProgressCollection","subscribeConfigFlowInProgress","localizeConfigFlowTitle","home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_0__","_common_util_debounce__WEBPACK_IMPORTED_MODULE_1__","_integration__WEBPACK_IMPORTED_MODULE_2__","handler","callApi","flowId","data","flow_id","fetchConfigFlowInProgress","conn","sendMessagePromise","subscribeConfigFlowInProgressUpdates","store","subscribeEvents","debounce","then","flows","setState","getCollection","onChange","connection","subscribe","flow","placeholders","context","title_placeholders","placeholderKeys","Object","keys","length","args","forEach","key","push","loadDataEntryFlowDialog","showFlowDialog","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_0__","all","e","bind","element","dialogParams","flowConfig","dialogTag","dialogImport","assign","loadConfigFlowDialog","showConfigFlowDialog","lit_element__WEBPACK_IMPORTED_MODULE_0__","_common_string_compare__WEBPACK_IMPORTED_MODULE_1__","_common_translations_localize__WEBPACK_IMPORTED_MODULE_2__","_data_config_flow__WEBPACK_IMPORTED_MODULE_3__","_data_integration__WEBPACK_IMPORTED_MODULE_4__","_show_dialog_data_entry_flow__WEBPACK_IMPORTED_MODULE_5__","loadDevicesAndAreas","getFlowHandlers","async","handlers","loadBackendTranslation","undefined","sort","handlerA","handlerB","createFlow","step","fetchFlow","handleFlowStep","deleteFlow","renderAbortDescription","description","localizeKey","reason","description_placeholders","html","renderShowFormStepHeader","step_id","renderShowFormStepDescription","renderShowFormStepFieldLabel","field","name","renderShowFormStepFieldError","error","renderExternalStepHeader","renderExternalStepDescription","renderCreateEntryDescription","title","setupLeafletMap","createTileLayer","mapElement","darkMode","draw","parentNode","Error","Leaflet","t","Icon","Default","imagePath","map","style","document","createElement","setAttribute","appendChild","setView","addTo","leaflet","tileLayer","Browser","retina","attribution","subdomains","minZoom","maxZoom","defaultRadiusColor","homeRadiusColor","passiveRadiusColor","fetchZones","createZone","updateZone","deleteZone","showZoneEditor","getZoneEditorInitData","_common_navigate__WEBPACK_IMPORTED_MODULE_0__","values","zoneId","updates","zone_id","inititialZoneEditorData","el","saveCoreConfig","detectCoreConfig","customElement","LocationEditor","_LitElement","[object Object]","super","_initialize","this","property","_leafletMap","location","_locationMarker","getBounds","fitBounds","fitZoom","_ignoreFitToMap","changedProps","_get","_getPrototypeOf","prototype","call","_initMap","has","_updateMarker","fitMap","_updateRadius","_updateRadiusColor","_updateIcon","shadowRoot","querySelector","_mapEl","Boolean","radius","addEventListener","ev","_locationUpdated","latlng","invalidateSize","longitude","lng","Math","abs","lat","bubbles","getRadius","icon","_iconEl","iconHTML","outerHTML","divIcon","iconSize","className","_setIcon","setIcon","editing","_moveMarker","enable","moveMarker","resizeMarker","_resizeMarkers","target","getLatLng","_radiusUpdated","setLatLng","disable","_setupEdit","circle","color","radiusColor","addLayer","marker","draggable","remove","setRadius","setStyle","css","LitElement","createTimezoneListEl","google_timezones_json__WEBPACK_IMPORTED_MODULE_0__","google_timezones_json__WEBPACK_IMPORTED_MODULE_0___default","n","list","id","timezones","option","value","innerHTML","amsterdam","OnboardingCoreConfig","onboardingLocalize","user","_working","_nameValue","_handleChange","_connectWifi","_detect","_locationValue","_locationChanged","_timeZoneValue","_elevationValue","_unitSystemValue","_unitSystemChanged","_save","focus","keyCode","inputElement","_name","_location","_elevation","_timeZone","_unitSystem","currentTarget","detail","latitude","Number","elevation","String","unit_system","time_zone","err","alert","message","result","_continueFlow","continueFlowId","dialogClosedCallback","preventDefault","location_name","onboardCoreConfigStep"],"mappings":"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","file":"chunk.a8151b1c601ce3530ea4.js","sourcesContent":["import { fireEvent } from \"./dom/fire_event\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"location-changed\": {\n      replace: boolean;\n    };\n  }\n}\n\nexport const navigate = (_node: any, path: string, replace = false) => {\n  if (__DEMO__) {\n    if (replace) {\n      history.replaceState(null, \"\", `${location.pathname}#${path}`);\n    } else {\n      window.location.hash = path;\n    }\n  } else if (replace) {\n    history.replaceState(null, \"\", path);\n  } else {\n    history.pushState(null, \"\", path);\n  }\n  fireEvent(window, \"location-changed\", {\n    replace,\n  });\n};\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","export const afterNextRender = (cb: () => void): void => {\n  requestAnimationFrame(() => setTimeout(cb, 0));\n};\n\nexport const nextRender = () => {\n  return new Promise((resolve) => {\n    afterNextRender(resolve);\n  });\n};\n","import { LocalizeFunc } from \"../common/translations/localize\";\nimport { HomeAssistant } from \"../types\";\n\nexport interface IntegrationManifest {\n  is_built_in: boolean;\n  domain: string;\n  name: string;\n  config_flow: boolean;\n  documentation: string;\n  dependencies?: string[];\n  after_dependencies?: string[];\n  codeowners?: string[];\n  requirements?: string[];\n  ssdp?: Array<{ manufacturer?: string; modelName?: string; st?: string }>;\n  zeroconf?: string[];\n  homekit?: { models: string[] };\n  quality_scale?: string;\n}\n\nexport const integrationIssuesUrl = (domain: string) =>\n  getIntegrationIssuesUrl(domain);\n\nexport const domainToName = (localize: LocalizeFunc, domain: string) =>\n  localize(`component.${domain}.title`) || domain;\n\nexport const fetchIntegrationManifests = (hass: HomeAssistant) =>\n  hass.callWS<IntegrationManifest[]>({ type: \"manifest/list\" });\n\nexport const fetchIntegrationManifest = (\n  hass: HomeAssistant,\n  integration: string\n) => hass.callWS<IntegrationManifest>({ type: \"manifest/get\", integration });\n","import { Connection, getCollection } from \"home-assistant-js-websocket\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\nimport { debounce } from \"../common/util/debounce\";\nimport { HomeAssistant } from \"../types\";\nimport { DataEntryFlowProgress, DataEntryFlowStep } from \"./data_entry_flow\";\nimport { domainToName } from \"./integration\";\n\nexport const DISCOVERY_SOURCES = [\"unignore\", \"homekit\", \"ssdp\", \"zeroconf\"];\n\nexport const createConfigFlow = (hass: HomeAssistant, handler: string) =>\n  hass.callApi<DataEntryFlowStep>(\"POST\", \"config/config_entries/flow\", {\n    handler,\n  });\n\nexport const fetchConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi<DataEntryFlowStep>(\n    \"GET\",\n    `config/config_entries/flow/${flowId}`\n  );\n\nexport const handleConfigFlowStep = (\n  hass: HomeAssistant,\n  flowId: string,\n  data: { [key: string]: any }\n) =>\n  hass.callApi<DataEntryFlowStep>(\n    \"POST\",\n    `config/config_entries/flow/${flowId}`,\n    data\n  );\n\nexport const ignoreConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callWS({ type: \"config_entries/ignore_flow\", flow_id: flowId });\n\nexport const deleteConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi(\"DELETE\", `config/config_entries/flow/${flowId}`);\n\nexport const getConfigFlowHandlers = (hass: HomeAssistant) =>\n  hass.callApi<string[]>(\"GET\", \"config/config_entries/flow_handlers\");\n\nconst fetchConfigFlowInProgress = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config_entries/flow/progress\",\n  });\n\nconst subscribeConfigFlowInProgressUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchConfigFlowInProgress(conn).then((flows) =>\n          store.setState(flows, true)\n        ),\n      500,\n      true\n    ),\n    \"config_entry_discovered\"\n  );\n\nexport const getConfigFlowInProgressCollection = (conn: Connection) =>\n  getCollection<DataEntryFlowProgress[]>(\n    conn,\n    \"_configFlowProgress\",\n    fetchConfigFlowInProgress,\n    subscribeConfigFlowInProgressUpdates\n  );\n\nexport const subscribeConfigFlowInProgress = (\n  hass: HomeAssistant,\n  onChange: (flows: DataEntryFlowProgress[]) => void\n) => getConfigFlowInProgressCollection(hass.connection).subscribe(onChange);\n\nexport const localizeConfigFlowTitle = (\n  localize: LocalizeFunc,\n  flow: DataEntryFlowProgress\n) => {\n  const placeholders = flow.context.title_placeholders || {};\n  const placeholderKeys = Object.keys(placeholders);\n  if (placeholderKeys.length === 0) {\n    return domainToName(localize, flow.handler);\n  }\n  const args: string[] = [];\n  placeholderKeys.forEach((key) => {\n    args.push(key);\n    args.push(placeholders[key]);\n  });\n  return localize(`component.${flow.handler}.config.flow_title`, ...args);\n};\n","import { TemplateResult } from \"lit-html\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { HaFormSchema } from \"../../components/ha-form/ha-form\";\nimport {\n  DataEntryFlowStep,\n  DataEntryFlowStepAbort,\n  DataEntryFlowStepCreateEntry,\n  DataEntryFlowStepExternal,\n  DataEntryFlowStepForm,\n} from \"../../data/data_entry_flow\";\nimport { HomeAssistant } from \"../../types\";\n\nexport interface FlowConfig {\n  loadDevicesAndAreas: boolean;\n\n  getFlowHandlers?: (hass: HomeAssistant) => Promise<string[]>;\n\n  createFlow(hass: HomeAssistant, handler: string): Promise<DataEntryFlowStep>;\n\n  fetchFlow(hass: HomeAssistant, flowId: string): Promise<DataEntryFlowStep>;\n\n  handleFlowStep(\n    hass: HomeAssistant,\n    flowId: string,\n    data: { [key: string]: any }\n  ): Promise<DataEntryFlowStep>;\n\n  deleteFlow(hass: HomeAssistant, flowId: string): Promise<unknown>;\n\n  renderAbortDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepAbort\n  ): TemplateResult | \"\";\n\n  renderShowFormStepHeader(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm\n  ): string;\n\n  renderShowFormStepDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm\n  ): TemplateResult | \"\";\n\n  renderShowFormStepFieldLabel(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm,\n    field: HaFormSchema\n  ): string;\n\n  renderShowFormStepFieldError(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm,\n    error: string\n  ): string;\n\n  renderExternalStepHeader(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepExternal\n  ): string;\n\n  renderExternalStepDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepExternal\n  ): TemplateResult | \"\";\n\n  renderCreateEntryDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepCreateEntry\n  ): TemplateResult | \"\";\n}\n\nexport interface DataEntryFlowDialogParams {\n  startFlowHandler?: string;\n  continueFlowId?: string;\n  dialogClosedCallback?: (params: { flowFinished: boolean }) => void;\n  flowConfig: FlowConfig;\n  showAdvanced?: boolean;\n}\n\nexport const loadDataEntryFlowDialog = () =>\n  import(\n    /* webpackChunkName: \"dialog-config-flow\" */ \"./dialog-data-entry-flow\"\n  );\n\nexport const showFlowDialog = (\n  element: HTMLElement,\n  dialogParams: Omit<DataEntryFlowDialogParams, \"flowConfig\">,\n  flowConfig: FlowConfig\n): void => {\n  fireEvent(element, \"show-dialog\", {\n    dialogTag: \"dialog-data-entry-flow\",\n    dialogImport: loadDataEntryFlowDialog,\n    dialogParams: {\n      ...dialogParams,\n      flowConfig,\n    },\n  });\n};\n","import { html } from \"lit-element\";\nimport { caseInsensitiveCompare } from \"../../common/string/compare\";\nimport { localizeKey } from \"../../common/translations/localize\";\nimport {\n  createConfigFlow,\n  deleteConfigFlow,\n  fetchConfigFlow,\n  getConfigFlowHandlers,\n  handleConfigFlowStep,\n} from \"../../data/config_flow\";\nimport { domainToName } from \"../../data/integration\";\nimport {\n  DataEntryFlowDialogParams,\n  loadDataEntryFlowDialog,\n  showFlowDialog,\n} from \"./show-dialog-data-entry-flow\";\n\nexport const loadConfigFlowDialog = loadDataEntryFlowDialog;\n\nexport const showConfigFlowDialog = (\n  element: HTMLElement,\n  dialogParams: Omit<DataEntryFlowDialogParams, \"flowConfig\">\n): void =>\n  showFlowDialog(element, dialogParams, {\n    loadDevicesAndAreas: true,\n    getFlowHandlers: async (hass) => {\n      const [handlers] = await Promise.all([\n        getConfigFlowHandlers(hass),\n        hass.loadBackendTranslation(\"title\", undefined, true),\n      ]);\n\n      return handlers.sort((handlerA, handlerB) =>\n        caseInsensitiveCompare(\n          domainToName(hass.localize, handlerA),\n          domainToName(hass.localize, handlerB)\n        )\n      );\n    },\n    createFlow: async (hass, handler) => {\n      const [step] = await Promise.all([\n        createConfigFlow(hass, handler),\n        hass.loadBackendTranslation(\"config\", handler),\n      ]);\n      return step;\n    },\n    fetchFlow: async (hass, flowId) => {\n      const step = await fetchConfigFlow(hass, flowId);\n      await hass.loadBackendTranslation(\"config\", step.handler);\n      return step;\n    },\n    handleFlowStep: handleConfigFlowStep,\n    deleteFlow: deleteConfigFlow,\n\n    renderAbortDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.abort.${step.reason}`,\n        step.description_placeholders\n      );\n\n      return description\n        ? html` <ha-markdown allowsvg .content=${description}></ha-markdown> `\n        : \"\";\n    },\n\n    renderShowFormStepHeader(hass, step) {\n      return (\n        hass.localize(\n          `component.${step.handler}.config.step.${step.step_id}.title`\n        ) || hass.localize(`component.${step.handler}.title`)\n      );\n    },\n\n    renderShowFormStepDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.step.${step.step_id}.description`,\n        step.description_placeholders\n      );\n      return description\n        ? html` <ha-markdown allowsvg .content=${description}></ha-markdown> `\n        : \"\";\n    },\n\n    renderShowFormStepFieldLabel(hass, step, field) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.data.${field.name}`\n      );\n    },\n\n    renderShowFormStepFieldError(hass, step, error) {\n      return hass.localize(`component.${step.handler}.config.error.${error}`);\n    },\n\n    renderExternalStepHeader(hass, step) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.title`\n      );\n    },\n\n    renderExternalStepDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.${step.step_id}.description`,\n        step.description_placeholders\n      );\n\n      return html`\n        <p>\n          ${hass.localize(\n            \"ui.panel.config.integrations.config_flow.external_step.description\"\n          )}\n        </p>\n        ${description\n          ? html` <ha-markdown allowsvg .content=${description}></ha-markdown> `\n          : \"\"}\n      `;\n    },\n\n    renderCreateEntryDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.create_entry.${\n          step.description || \"default\"\n        }`,\n        step.description_placeholders\n      );\n\n      return html`\n        ${description\n          ? html` <ha-markdown allowsvg .content=${description}></ha-markdown> `\n          : \"\"}\n        <p>\n          ${hass.localize(\n            \"ui.panel.config.integrations.config_flow.created_config\",\n            \"name\",\n            step.title\n          )}\n        </p>\n      `;\n    },\n  });\n","import { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\nexport type LeafletDrawModuleType = typeof import(\"leaflet-draw\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement,\n  darkMode = false,\n  draw = false\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // eslint-disable-next-line\n  const Leaflet = (await import(\n    /* webpackChunkName: \"leaflet\" */ \"leaflet\"\n  )) as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  if (draw) {\n    await import(/* webpackChunkName: \"leaflet-draw\" */ \"leaflet-draw\");\n  }\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  createTileLayer(Leaflet, darkMode).addTo(map);\n\n  return [map, Leaflet];\n};\n\nexport const createTileLayer = (\n  leaflet: LeafletModuleType,\n  darkMode: boolean\n) => {\n  return leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/${\n      darkMode ? \"dark_all\" : \"light_all\"\n    }/{z}/{x}/{y}${leaflet.Browser.retina ? \"@2x.png\" : \".png\"}`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  );\n};\n","import { navigate } from \"../common/navigate\";\nimport { HomeAssistant } from \"../types\";\n\nexport const defaultRadiusColor = \"#FF9800\";\nexport const homeRadiusColor = \"#ff9800\";\nexport const passiveRadiusColor = \"#9b9b9b\";\n\nexport interface Zone {\n  id: string;\n  name: string;\n  icon?: string;\n  latitude: number;\n  longitude: number;\n  passive?: boolean;\n  radius?: number;\n}\n\nexport interface ZoneMutableParams {\n  icon: string;\n  latitude: number;\n  longitude: number;\n  name: string;\n  passive: boolean;\n  radius: number;\n}\n\nexport const fetchZones = (hass: HomeAssistant) =>\n  hass.callWS<Zone[]>({ type: \"zone/list\" });\n\nexport const createZone = (hass: HomeAssistant, values: ZoneMutableParams) =>\n  hass.callWS<Zone>({\n    type: \"zone/create\",\n    ...values,\n  });\n\nexport const updateZone = (\n  hass: HomeAssistant,\n  zoneId: string,\n  updates: Partial<ZoneMutableParams>\n) =>\n  hass.callWS<Zone>({\n    type: \"zone/update\",\n    zone_id: zoneId,\n    ...updates,\n  });\n\nexport const deleteZone = (hass: HomeAssistant, zoneId: string) =>\n  hass.callWS({\n    type: \"zone/delete\",\n    zone_id: zoneId,\n  });\n\nlet inititialZoneEditorData: Partial<ZoneMutableParams> | undefined;\n\nexport const showZoneEditor = (\n  el: HTMLElement,\n  data?: Partial<ZoneMutableParams>\n) => {\n  inititialZoneEditorData = data;\n  navigate(el, \"/config/zone/new\");\n};\n\nexport const getZoneEditorInitData = () => {\n  const data = inititialZoneEditorData;\n  inititialZoneEditorData = undefined;\n  return data;\n};\n","import { HassConfig } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\n\nexport interface ConfigUpdateValues {\n  location_name: string;\n  latitude: number;\n  longitude: number;\n  elevation: number;\n  unit_system: \"metric\" | \"imperial\";\n  time_zone: string;\n}\n\nexport const saveCoreConfig = (\n  hass: HomeAssistant,\n  values: Partial<ConfigUpdateValues>\n) =>\n  hass.callWS<HassConfig>({\n    type: \"config/core/update\",\n    ...values,\n  });\n\nexport const detectCoreConfig = (hass: HomeAssistant) =>\n  hass.callWS<Partial<ConfigUpdateValues>>({\n    type: \"config/core/detect\",\n  });\n","import {\n  Circle,\n  DivIcon,\n  DragEndEvent,\n  LatLng,\n  LeafletMouseEvent,\n  Map,\n  Marker,\n} from \"leaflet\";\nimport {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  PropertyValues,\n  TemplateResult,\n} from \"lit-element\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport {\n  LeafletModuleType,\n  setupLeafletMap,\n} from \"../../common/dom/setup-leaflet-map\";\nimport { nextRender } from \"../../common/util/render-status\";\nimport { defaultRadiusColor } from \"../../data/zone\";\n\n@customElement(\"ha-location-editor\")\nclass LocationEditor extends LitElement {\n  @property() public location?: [number, number];\n\n  @property() public radius?: number;\n\n  @property() public radiusColor?: string;\n\n  @property() public icon?: string;\n\n  public fitZoom = 16;\n\n  private _iconEl?: DivIcon;\n\n  private _ignoreFitToMap?: [number, number];\n\n  // eslint-disable-next-line\n  private Leaflet?: LeafletModuleType;\n\n  private _leafletMap?: Map;\n\n  private _locationMarker?: Marker | Circle;\n\n  public fitMap(): void {\n    if (!this._leafletMap || !this.location) {\n      return;\n    }\n    if ((this._locationMarker as Circle).getBounds) {\n      this._leafletMap.fitBounds((this._locationMarker as Circle).getBounds());\n    } else {\n      this._leafletMap.setView(this.location, this.fitZoom);\n    }\n    this._ignoreFitToMap = this.location;\n  }\n\n  protected render(): TemplateResult {\n    return html` <div id=\"map\"></div> `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this._initMap();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    // Still loading.\n    if (!this.Leaflet) {\n      return;\n    }\n\n    if (changedProps.has(\"location\")) {\n      this._updateMarker();\n      if (\n        this.location &&\n        (!this._ignoreFitToMap ||\n          this._ignoreFitToMap[0] !== this.location[0] ||\n          this._ignoreFitToMap[1] !== this.location[1])\n      ) {\n        this.fitMap();\n      }\n    }\n    if (changedProps.has(\"radius\")) {\n      this._updateRadius();\n    }\n    if (changedProps.has(\"radiusColor\")) {\n      this._updateRadiusColor();\n    }\n    if (changedProps.has(\"icon\")) {\n      this._updateIcon();\n    }\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.querySelector(\"div\")!;\n  }\n\n  private async _initMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(\n      this._mapEl,\n      false,\n      Boolean(this.radius)\n    );\n    this._leafletMap.addEventListener(\n      \"click\",\n      // @ts-ignore\n      (ev: LeafletMouseEvent) => this._locationUpdated(ev.latlng)\n    );\n    this._updateIcon();\n    this._updateMarker();\n    this.fitMap();\n    this._leafletMap.invalidateSize();\n  }\n\n  private _locationUpdated(latlng: LatLng) {\n    let longitude = latlng.lng;\n    if (Math.abs(longitude) > 180.0) {\n      // Normalize longitude if map provides values beyond -180 to +180 degrees.\n      longitude = (((longitude % 360.0) + 540.0) % 360.0) - 180.0;\n    }\n    this.location = this._ignoreFitToMap = [latlng.lat, longitude];\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _radiusUpdated() {\n    this._ignoreFitToMap = this.location;\n    this.radius = (this._locationMarker as Circle).getRadius();\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _updateIcon() {\n    if (!this.icon) {\n      this._iconEl = undefined;\n      return;\n    }\n\n    // create icon\n    let iconHTML = \"\";\n    const el = document.createElement(\"ha-icon\");\n    el.setAttribute(\"icon\", this.icon);\n    iconHTML = el.outerHTML;\n\n    this._iconEl = this.Leaflet!.divIcon({\n      html: iconHTML,\n      iconSize: [24, 24],\n      className: \"light leaflet-edit-move\",\n    });\n    this._setIcon();\n  }\n\n  private _setIcon() {\n    if (!this._locationMarker || !this._iconEl) {\n      return;\n    }\n\n    if (!this.radius) {\n      (this._locationMarker as Marker).setIcon(this._iconEl);\n      return;\n    }\n\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    moveMarker.setIcon(this._iconEl);\n  }\n\n  private _setupEdit() {\n    // @ts-ignore\n    this._locationMarker.editing.enable();\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    // @ts-ignore\n    const resizeMarker = this._locationMarker.editing._resizeMarkers[0];\n    this._setIcon();\n    moveMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n    );\n    resizeMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._radiusUpdated(ev)\n    );\n  }\n\n  private async _updateMarker(): Promise<void> {\n    if (!this.location) {\n      if (this._locationMarker) {\n        this._locationMarker.remove();\n        this._locationMarker = undefined;\n      }\n      return;\n    }\n\n    if (this._locationMarker) {\n      this._locationMarker.setLatLng(this.location);\n      if (this.radius) {\n        // @ts-ignore\n        this._locationMarker.editing.disable();\n        await nextRender();\n        this._setupEdit();\n      }\n      return;\n    }\n\n    if (!this.radius) {\n      this._locationMarker = this.Leaflet!.marker(this.location, {\n        draggable: true,\n      });\n      this._setIcon();\n      this._locationMarker.addEventListener(\n        \"dragend\",\n        // @ts-ignore\n        (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n      );\n      this._leafletMap!.addLayer(this._locationMarker);\n    } else {\n      this._locationMarker = this.Leaflet!.circle(this.location, {\n        color: this.radiusColor || defaultRadiusColor,\n        radius: this.radius,\n      });\n      this._leafletMap!.addLayer(this._locationMarker);\n      this._setupEdit();\n    }\n  }\n\n  private _updateRadius(): void {\n    if (!this._locationMarker || !this.radius) {\n      return;\n    }\n    (this._locationMarker as Circle).setRadius(this.radius);\n  }\n\n  private _updateRadiusColor(): void {\n    if (!this._locationMarker || !this.radius) {\n      return;\n    }\n    (this._locationMarker as Circle).setStyle({ color: this.radiusColor });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        height: 300px;\n      }\n      #map {\n        height: 100%;\n      }\n      .light {\n        color: #000000;\n      }\n      .leaflet-edit-move {\n        border-radius: 50%;\n        cursor: move !important;\n      }\n      .leaflet-edit-resize {\n        border-radius: 50%;\n        cursor: nesw-resize !important;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-location-editor\": LocationEditor;\n  }\n}\n","import timezones from \"google-timezones-json\";\n\nexport const createTimezoneListEl = () => {\n  const list = document.createElement(\"datalist\");\n  list.id = \"timezones\";\n  Object.keys(timezones).forEach((key) => {\n    const option = document.createElement(\"option\");\n    option.value = key;\n    option.innerHTML = timezones[key];\n    list.appendChild(option);\n  });\n  return list;\n};\n","import \"@material/mwc-button/mwc-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport type { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-radio-button/paper-radio-button\";\nimport \"@polymer/paper-radio-group/paper-radio-group\";\nimport {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n} from \"lit-element\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport type { LocalizeFunc } from \"../common/translations/localize\";\nimport \"../components/map/ha-location-editor\";\nimport { createTimezoneListEl } from \"../components/timezone-datalist\";\nimport {\n  ConfigUpdateValues,\n  detectCoreConfig,\n  saveCoreConfig,\n} from \"../data/core\";\nimport { showConfigFlowDialog } from \"../dialogs/config-flow/show-dialog-config-flow\";\nimport { onboardCoreConfigStep } from \"../data/onboarding\";\nimport type { PolymerChangedEvent } from \"../polymer-types\";\nimport type { HomeAssistant } from \"../types\";\n\nconst amsterdam = [52.069521, 19.480343];\n\n@customElement(\"onboarding-core-config\")\nclass OnboardingCoreConfig extends LitElement {\n  @property() public hass!: HomeAssistant;\n\n  @property() public onboardingLocalize!: LocalizeFunc;\n\n  @property() private _working = false;\n\n  @property() private _name!: ConfigUpdateValues[\"location_name\"];\n\n  @property() private _location!: [number, number];\n\n  @property() private _elevation!: string;\n\n  @property() private _unitSystem!: ConfigUpdateValues[\"unit_system\"];\n\n  @property() private _timeZone!: string;\n\n  protected render(): TemplateResult {\n    return html`\n      <p>\n        ${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.intro\",\n          \"name\",\n          this.hass.user!.name\n        )}\n      </p>\n\n      <paper-input\n        .label=${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name\"\n        )}\n        name=\"name\"\n        .disabled=${this._working}\n        .value=${this._nameValue}\n        @value-changed=${this._handleChange}\n      ></paper-input>\n\n      <div class=\"middle-text\">\n        <p>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.intro_location\"\n          )}\n        </p>\n        <div class=\"row\">\n          <div>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.intro_location_detect\"\n            )}\n            Do tego jest potrzebne połączenie z Internetem.\n          </div>\n          <mwc-button @click=${this._connectWifi}>\n            POŁĄCZ Z WIFI\n          </mwc-button>\n        </div>\n\n        <div class=\"row\">\n          <div>\n            Ustal swoją lokalizację po adresie IP wysyłając jednorazowe\n            zapytanie do serwisu\n            <span style=\"font-weight: bold;\" @click=${this._detect}\n              >ipapi.co</span\n            >\n          </div>\n          <mwc-button @click=${this._detect}>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.button_detect\"\n            )}\n          </mwc-button>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <ha-location-editor\n          class=\"flex\"\n          .location=${this._locationValue}\n          .fitZoom=${14}\n          @change=${this._locationChanged}\n          style=\"z-index:100\"\n        ></ha-location-editor>\n      </div>\n\n      <div class=\"row\">\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.time_zone\"\n          )}\n          name=\"timeZone\"\n          list=\"timezones\"\n          .disabled=${this._working}\n          .value=${this._timeZoneValue}\n          @value-changed=${this._handleChange}\n        ></paper-input>\n\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.elevation\"\n          )}\n          name=\"elevation\"\n          type=\"number\"\n          .disabled=${this._working}\n          .value=${this._elevationValue}\n          @value-changed=${this._handleChange}\n        >\n          <span slot=\"suffix\">\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.elevation_meters\"\n            )}\n          </span>\n        </paper-input>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"flex\">\n          ${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.unit_system\"\n          )}\n        </div>\n        <paper-radio-group\n          class=\"flex\"\n          .selected=${this._unitSystemValue}\n          @selected-changed=${this._unitSystemChanged}\n        >\n          <paper-radio-button name=\"metric\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_metric\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.metric_example\"\n              )}\n            </div>\n          </paper-radio-button>\n          <paper-radio-button name=\"imperial\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_imperial\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.imperial_example\"\n              )}\n            </div>\n          </paper-radio-button>\n        </paper-radio-group>\n      </div>\n\n      <div class=\"footer\">\n        <mwc-button @click=${this._save} .disabled=${this._working}>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.finish\"\n          )}\n        </mwc-button>\n      </div>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    setTimeout(\n      () => this.shadowRoot!.querySelector(\"paper-input\")!.focus(),\n      100\n    );\n    this.addEventListener(\"keypress\", (ev) => {\n      if (ev.keyCode === 13) {\n        this._save(ev);\n      }\n    });\n    const input = this.shadowRoot!.querySelector(\n      \"[name=timeZone]\"\n    ) as PaperInputElement;\n    input.inputElement.appendChild(createTimezoneListEl());\n  }\n\n  private get _nameValue() {\n    return this._name !== undefined\n      ? this._name\n      : this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name_default\"\n        );\n  }\n\n  private get _locationValue() {\n    return this._location || amsterdam;\n  }\n\n  private get _elevationValue() {\n    return this._elevation !== undefined ? this._elevation : 0;\n  }\n\n  private get _timeZoneValue() {\n    return this._timeZone;\n  }\n\n  private get _unitSystemValue() {\n    return this._unitSystem !== undefined ? this._unitSystem : \"metric\";\n  }\n\n  private _handleChange(ev: PolymerChangedEvent<string>) {\n    const target = ev.currentTarget as PaperInputElement;\n    this[`_${target.name}`] = target.value;\n  }\n\n  private _locationChanged(ev) {\n    this._location = ev.currentTarget.location;\n  }\n\n  private _unitSystemChanged(\n    ev: PolymerChangedEvent<ConfigUpdateValues[\"unit_system\"]>\n  ) {\n    this._unitSystem = ev.detail.value;\n  }\n\n  private async _detect() {\n    this._working = true;\n    try {\n      const values = await detectCoreConfig(this.hass);\n      if (values.latitude && values.longitude) {\n        this._location = [Number(values.latitude), Number(values.longitude)];\n      }\n      if (values.elevation) {\n        this._elevation = String(values.elevation);\n      }\n      if (values.unit_system) {\n        this._unitSystem = values.unit_system;\n      }\n      if (values.time_zone) {\n        this._timeZone = values.time_zone;\n      }\n    } catch (err) {\n      alert(`Failed to detect location information: ${err.message}`);\n    } finally {\n      this._working = false;\n    }\n  }\n\n  private _connectWifi() {\n    this.hass\n      .callApi(\"POST\", \"config/config_entries/flow\", {\n        handler: \"ais_wifi_service\",\n      })\n      .then((result: any) => {\n        this._continueFlow(result.flow_id);\n      });\n  }\n\n  private _continueFlow(flowId) {\n    showConfigFlowDialog(this, {\n      continueFlowId: flowId,\n      dialogClosedCallback: () => {\n        return;\n      },\n    });\n  }\n\n  private async _save(ev) {\n    ev.preventDefault();\n    this._working = true;\n    try {\n      const location = this._locationValue;\n      await saveCoreConfig(this.hass, {\n        location_name: this._nameValue,\n        latitude: location[0],\n        longitude: location[1],\n        elevation: Number(this._elevationValue),\n        unit_system: this._unitSystemValue,\n        time_zone: this._timeZoneValue || \"UTC\",\n      });\n      const result = await onboardCoreConfigStep(this.hass);\n      fireEvent(this, \"onboarding-step\", {\n        type: \"core_config\",\n        result,\n      });\n    } catch (err) {\n      this._working = false;\n      alert(`Failed to save: ${err.message}`);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .row {\n        display: flex;\n        flex-direction: row;\n        margin: 0 -8px;\n        align-items: center;\n      }\n\n      .secondary {\n        color: var(--secondary-text-color);\n      }\n\n      .flex {\n        flex: 1;\n      }\n\n      .middle-text {\n        margin: 24px 0;\n      }\n\n      .row > * {\n        margin: 0 8px;\n      }\n      .footer {\n        margin-top: 16px;\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"onboarding-core-config\": OnboardingCoreConfig;\n  }\n}\n"],"sourceRoot":""}