{"version":3,"sources":["webpack:///./src/panels/lovelace/common/color/luminanace.ts","webpack:///./src/panels/lovelace/common/color/contrast.ts","webpack:///./src/panels/lovelace/components/hui-marquee.ts","webpack:///./src/panels/lovelace/cards/hui-media-control-card.ts"],"names":["luminanace","r","g","b","a","map","v","Math","pow","contrast","rgb1","rgb2","lum1","apply","_toConsumableArray","lum2","max","min","customElement","HuiMarquee","property","type","Boolean","reflect","attribute","changedProps","_this2","this","_get","_getPrototypeOf","prototype","call","addEventListener","classList","add","capture","remove","changedProperties","has","_animating","active","offsetWidth","scrollWidth","text","html","_templateObject2","_onIteration","_templateObject3","_templateObject","css","_templateObject4","LitElement","customGenerator","colors","sort","colorA","colorB","population","foregroundColor","backgroundColor","contrastRatios","Map","approvedContrastRatio","color","set","rgb","round","Number","EPSILON","get","CONTRAST_RATIO","i","length","undefined","__DEV__","hex","currentColor","j","compareColor","diffScore","abs","bodyTextColor","HuiMediaControlCard","hui_media_control_card_decorate","_initialize","_LitElement","_LitElement2","hui_media_control_card_inherits","_super","hui_media_control_card_createSuper","_this","hui_media_control_card_classCallCheck","_len","arguments","args","Array","_key","concat","hui_media_control_card_assertThisInitialized","F","d","kind","static","key","value","_getConfigElement","_asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","Promise","all","__webpack_require__","e","then","bind","abrupt","document","createElement","stop","hass","entities","entitiesFallback","entity","findEntities","decorators","query","config","split","Error","_config","hui_media_control_card_get","hui_media_control_card_getPrototypeOf","updateComplete","_attachObserver","stateObj","_stateObj","_progressInterval","_showProgressBar","state","window","setInterval","_updateProgressBar","clearInterval","_resizeObserver","disconnect","_this3","hui_media_control_card_templateObject","hui_media_control_card_templateObject2","localize","imageStyle","background-image","_image","hassUrl","width","_cardHeight","background-color","_backgroundColor","gradientStyle","isOffState","isUnavailable","UNAVAILABLE_STATES","includes","supportsFeature","SUPPORT_TURN_ON","hasNoImage","controls","_getControls","showControls","_veryNarrow","mediaDescription","computeMediaDescription","hui_media_control_card_templateObject3","classMap","no-image","off","unavailable","styleMap","hui_media_control_card_templateObject4","narrow","_narrow","no-progress","no-controls","_foregroundColor","stateIcon","name","computeStateName","states","_handleMoreInfo","_templateObject5","paddingRight","attributes","media_title","_templateObject6","_marqueeActive","_marqueeMouseOver","_marqueeMouseLeave","_templateObject7","control","_templateObject8","icon","action","_handleClick","_templateObject9","media_duration","--paper-progress-active-color","cursor","SUPPORT_SEEK","_handleSeek","hasConfigOrEntityChanged","_oldHass$states$this$","_oldHass$states$this$2","_this4","oldHass","oldConfig","themes","theme","applyThemesOnElement","oldImage","entity_picture_local","entity_picture","_setColors","SUPPORT_TURN_OFF","SUPPORTS_PLAY","buttons","SUPPORT_PREVIOUS_TRACK","push","SUPPORT_PAUSE","SUPPORT_STOP","SUPPORT_NEXT_TRACK","card","shadowRoot","querySelector","offsetHeight","_attachObserver2","_callee2","_this5","_context2","installResizeObserver","ResizeObserver","debounce","_measureCard","observe","fireEvent","entityId","callService","currentTarget","getAttribute","entity_id","_progressBar","getCurrentProgress","progressWidth","percent","offsetX","position","seek_position","_this6","Vibrant","colorCount","generator","getPalette","_ref","_ref2","_slicedToArray","foreground","background","err","console","error","_templateObject10"],"mappings":"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","file":"chunk.0c3a2c5efb853427ce03.js","sourcesContent":["export const luminanace = (r: number, g: number, b: number): number => {\n  const a = [r, g, b].map((v) => {\n    v /= 255;\n    return v <= 0.03928 ? v / 12.92 : ((v + 0.055) / 1.055) ** 2.4;\n  });\n  return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;\n};\n","import { luminanace } from \"./luminanace\";\n\nexport const contrast = (\n  rgb1: [number, number, number],\n  rgb2: [number, number, number]\n): number => {\n  const lum1 = luminanace(...rgb1);\n  const lum2 = luminanace(...rgb2);\n  const brightest = Math.max(lum1, lum2);\n  const darkest = Math.min(lum1, lum2);\n  return (brightest + 0.05) / (darkest + 0.05);\n};\n","import {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  PropertyValues,\n  TemplateResult,\n} from \"lit-element\";\n\n@customElement(\"hui-marquee\")\nclass HuiMarquee extends LitElement {\n  @property() public text?: string;\n\n  @property({ type: Boolean }) public active?: boolean;\n\n  @property({ reflect: true, type: Boolean, attribute: \"animating\" })\n  private _animating = false;\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n\n    // eslint-disable-next-line wc/no-self-class\n    this.addEventListener(\"mouseover\", () => this.classList.add(\"hovering\"), {\n      // Capture because we need to run before a parent sets active on us.\n      // Hovering will disable the overflow, allowing us to calc if we overflow.\n      capture: true,\n    });\n    // eslint-disable-next-line wc/no-self-class\n    this.addEventListener(\"mouseout\", () => this.classList.remove(\"hovering\"));\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    if (changedProperties.has(\"text\") && this._animating) {\n      this._animating = false;\n    }\n\n    if (\n      changedProperties.has(\"active\") &&\n      this.active &&\n      this.offsetWidth < this.scrollWidth\n    ) {\n      this._animating = true;\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this.text) {\n      return html``;\n    }\n\n    return html`\n      <div class=\"marquee-inner\" @animationiteration=${this._onIteration}>\n        <span>${this.text}</span>\n        ${this._animating ? html` <span>${this.text}</span> ` : \"\"}\n      </div>\n    `;\n  }\n\n  private _onIteration() {\n    if (!this.active) {\n      this._animating = false;\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        position: relative;\n        align-items: center;\n        height: 1em;\n        contain: strict;\n      }\n\n      .marquee-inner {\n        position: absolute;\n        left: 0;\n        right: 0;\n        text-overflow: ellipsis;\n        overflow: hidden;\n      }\n\n      :host(.hovering) .marquee-inner {\n        text-overflow: initial;\n        overflow: initial;\n      }\n\n      :host([animating]) .marquee-inner {\n        left: initial;\n        right: initial;\n        animation: marquee 10s linear infinite;\n      }\n\n      :host([animating]) .marquee-inner span {\n        padding-right: 16px;\n      }\n\n      @keyframes marquee {\n        0% {\n          transform: translateX(0%);\n        }\n        100% {\n          transform: translateX(-50%);\n        }\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-marquee\": HuiMarquee;\n  }\n}\n","import \"../../../components/ha-icon-button\";\nimport \"@polymer/paper-progress/paper-progress\";\nimport type { PaperProgressElement } from \"@polymer/paper-progress/paper-progress\";\nimport {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  PropertyValues,\n  query,\n  TemplateResult,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport Vibrant from \"node-vibrant\";\nimport { Swatch } from \"node-vibrant/lib/color\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport { stateIcon } from \"../../../common/entity/state_icon\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport { UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport {\n  computeMediaDescription,\n  CONTRAST_RATIO,\n  getCurrentProgress,\n  SUPPORTS_PLAY,\n  SUPPORT_NEXT_TRACK,\n  SUPPORT_PAUSE,\n  SUPPORT_PREVIOUS_TRACK,\n  SUPPORT_SEEK,\n  SUPPORT_STOP,\n  SUPPORT_TURN_OFF,\n  SUPPORT_TURN_ON,\n} from \"../../../data/media-player\";\nimport type { HomeAssistant, MediaEntity } from \"../../../types\";\nimport { contrast } from \"../common/color/contrast\";\nimport { findEntities } from \"../common/find-entites\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport \"../components/hui-marquee\";\nimport type { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport \"../components/hui-warning\";\nimport { MediaControlCardConfig } from \"./types\";\nimport { installResizeObserver } from \"../common/install-resize-observer\";\n\nfunction getContrastRatio(\n  rgb1: [number, number, number],\n  rgb2: [number, number, number]\n): number {\n  return Math.round((contrast(rgb1, rgb2) + Number.EPSILON) * 100) / 100;\n}\n\n// How much the total diff between 2 RGB colors can be\n// to be considered similar.\nconst COLOR_SIMILARITY_THRESHOLD = 150;\n\n// For debug purposes, is being tree shaken.\nconst DEBUG_COLOR = __DEV__ && false;\n\nconst logColor = (\n  color: Swatch,\n  label = `${color.getHex()} - ${color.getPopulation()}`\n) =>\n  // eslint-disable-next-line no-console\n  console.log(\n    `%c${label}`,\n    `color: ${color.getBodyTextColor()}; background-color: ${color.getHex()}`\n  );\n\nconst customGenerator = (colors: Swatch[]) => {\n  colors.sort((colorA, colorB) => colorB.population - colorA.population);\n\n  const backgroundColor = colors[0];\n  let foregroundColor: string | undefined;\n\n  const contrastRatios = new Map<Swatch, number>();\n  const approvedContrastRatio = (color: Swatch) => {\n    if (!contrastRatios.has(color)) {\n      contrastRatios.set(\n        color,\n        getContrastRatio(backgroundColor.rgb, color.rgb)\n      );\n    }\n\n    return contrastRatios.get(color)! > CONTRAST_RATIO;\n  };\n\n  // We take each next color and find one that has better contrast.\n  for (let i = 1; i < colors.length && foregroundColor === undefined; i++) {\n    // If this color matches, score, take it.\n    if (approvedContrastRatio(colors[i])) {\n      if (DEBUG_COLOR) {\n        logColor(colors[i], \"PICKED\");\n      }\n      foregroundColor = colors[i].hex;\n      break;\n    }\n\n    // This color has the wrong contrast ratio, but it is the right color.\n    // Let's find similar colors that might have the right contrast ratio\n\n    const currentColor = colors[i];\n    if (DEBUG_COLOR) {\n      logColor(colors[i], \"Finding similar color with better contrast\");\n    }\n\n    for (let j = i + 1; j < colors.length; j++) {\n      const compareColor = colors[j];\n\n      // difference. 0 is same, 765 max difference\n      const diffScore =\n        Math.abs(currentColor.rgb[0] - compareColor.rgb[0]) +\n        Math.abs(currentColor.rgb[1] - compareColor.rgb[1]) +\n        Math.abs(currentColor.rgb[2] - compareColor.rgb[2]);\n\n      if (DEBUG_COLOR) {\n        logColor(colors[j], `${colors[j].hex} - ${diffScore}`);\n      }\n\n      if (diffScore > COLOR_SIMILARITY_THRESHOLD) {\n        continue;\n      }\n\n      if (approvedContrastRatio(compareColor)) {\n        if (DEBUG_COLOR) {\n          logColor(compareColor, \"PICKED\");\n        }\n        foregroundColor = compareColor.hex;\n        break;\n      }\n    }\n  }\n\n  if (foregroundColor === undefined) {\n    foregroundColor = backgroundColor.bodyTextColor;\n  }\n\n  if (DEBUG_COLOR) {\n    // eslint-disable-next-line no-console\n    console.log();\n    // eslint-disable-next-line no-console\n    console.log(\n      \"%cPicked colors\",\n      `color: ${foregroundColor}; background-color: ${backgroundColor.hex}; font-weight: bold; padding: 16px;`\n    );\n    colors.forEach((color) => logColor(color));\n    // eslint-disable-next-line no-console\n    console.log();\n  }\n\n  return [foregroundColor, backgroundColor.hex];\n};\n\ninterface ControlButton {\n  icon: string;\n  action: string;\n}\n\n@customElement(\"hui-media-control-card\")\nexport class HuiMediaControlCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\n      /* webpackChunkName: \"hui-media-control-card-editor\" */ \"../editor/config-elements/hui-media-control-card-editor\"\n    );\n    return document.createElement(\"hui-media-control-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): MediaControlCardConfig {\n    const includeDomains = [\"media_player\"];\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      includeDomains\n    );\n\n    return { type: \"media-control\", entity: foundEntities[0] || \"\" };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: MediaControlCardConfig;\n\n  @property() private _foregroundColor?: string;\n\n  @property() private _backgroundColor?: string;\n\n  @property() private _narrow = false;\n\n  @property() private _veryNarrow = false;\n\n  @property() private _cardHeight = 0;\n\n  @query(\"paper-progress\") private _progressBar?: PaperProgressElement;\n\n  @property() private _marqueeActive = false;\n\n  private _progressInterval?: number;\n\n  private _resizeObserver?: ResizeObserver;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: MediaControlCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"media_player\") {\n      throw new Error(\"Specify an entity from within the media_player domain.\");\n    }\n\n    this._config = config;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this.updateComplete.then(() => this._attachObserver());\n\n    if (!this.hass || !this._config) {\n      return;\n    }\n\n    const stateObj = this._stateObj;\n\n    if (!stateObj) {\n      return;\n    }\n\n    if (\n      !this._progressInterval &&\n      this._showProgressBar &&\n      stateObj.state === \"playing\"\n    ) {\n      this._progressInterval = window.setInterval(\n        () => this._updateProgressBar(),\n        1000\n      );\n    }\n  }\n\n  public disconnectedCallback(): void {\n    if (this._progressInterval) {\n      clearInterval(this._progressInterval);\n      this._progressInterval = undefined;\n    }\n    if (this._resizeObserver) {\n      this._resizeObserver.disconnect();\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n    const stateObj = this._stateObj;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const imageStyle = {\n      \"background-image\": this._image\n        ? `url(${this.hass.hassUrl(this._image)})`\n        : \"none\",\n      width: `${this._cardHeight}px`,\n      \"background-color\": this._backgroundColor || \"\",\n    };\n\n    const gradientStyle = {\n      \"background-image\": `linear-gradient(to right, ${\n        this._backgroundColor\n      }, ${this._backgroundColor + \"00\"})`,\n      width: `${this._cardHeight}px`,\n    };\n\n    const state = stateObj.state;\n\n    const isOffState = state === \"off\";\n    const isUnavailable =\n      UNAVAILABLE_STATES.includes(state) ||\n      (state === \"off\" && !supportsFeature(stateObj, SUPPORT_TURN_ON));\n    const hasNoImage = !this._image;\n    const controls = this._getControls();\n    const showControls =\n      controls &&\n      (!this._veryNarrow || isOffState || state === \"idle\" || state === \"on\");\n\n    const mediaDescription = computeMediaDescription(stateObj);\n\n    return html`\n      <ha-card>\n        <div\n          class=\"background ${classMap({\n            \"no-image\": hasNoImage,\n            off: isOffState || isUnavailable,\n            unavailable: isUnavailable,\n          })}\"\n        >\n          <div\n            class=\"color-block\"\n            style=${styleMap({\n              \"background-color\": this._backgroundColor || \"\",\n            })}\n          ></div>\n          <div\n            class=\"no-img\"\n            style=${styleMap({\n              \"background-color\": this._backgroundColor || \"\",\n            })}\n          ></div>\n          <div class=\"image\" style=${styleMap(imageStyle)}></div>\n          ${hasNoImage\n            ? \"\"\n            : html`\n                <div\n                  class=\"color-gradient\"\n                  style=${styleMap(gradientStyle)}\n                ></div>\n              `}\n        </div>\n        <div\n          class=\"player ${classMap({\n            \"no-image\": hasNoImage,\n            narrow: this._narrow && !this._veryNarrow,\n            off: isOffState || isUnavailable,\n            \"no-progress\": this._veryNarrow || !this._showProgressBar,\n            \"no-controls\": !showControls,\n          })}\"\n          style=${styleMap({ color: this._foregroundColor || \"\" })}\n        >\n          <div class=\"top-info\">\n            <div class=\"icon-name\">\n              <ha-icon class=\"icon\" .icon=${stateIcon(stateObj)}></ha-icon>\n              <div>\n                ${this._config!.name ||\n                computeStateName(this.hass!.states[this._config!.entity])}\n              </div>\n            </div>\n            <div>\n              <ha-icon-button\n                icon=\"hass:dots-vertical\"\n                class=\"more-info\"\n                @click=${this._handleMoreInfo}\n              ></ha-icon-button>\n            </div>\n          </div>\n          ${isUnavailable\n            ? \"\"\n            : html`\n                <div\n                  class=\"title-controls\"\n                  style=${styleMap({\n                    paddingRight: isOffState\n                      ? \"0\"\n                      : `${this._cardHeight - 40}px`,\n                  })}\n                >\n                  ${!mediaDescription && !stateObj.attributes.media_title\n                    ? \"\"\n                    : html`\n                        <div class=\"media-info\">\n                          <hui-marquee\n                            .text=${stateObj.attributes.media_title ||\n                            mediaDescription}\n                            .active=${this._marqueeActive}\n                            @mouseover=${this._marqueeMouseOver}\n                            @mouseleave=${this._marqueeMouseLeave}\n                          ></hui-marquee>\n                          ${!stateObj.attributes.media_title\n                            ? \"\"\n                            : mediaDescription}\n                        </div>\n                      `}\n                  ${!showControls\n                    ? \"\"\n                    : html`\n                        <div class=\"controls\">\n                          ${controls!.map(\n                            (control) => html`\n                              <ha-icon-button\n                                .icon=${control.icon}\n                                action=${control.action}\n                                @click=${this._handleClick}\n                              ></ha-icon-button>\n                            `\n                          )}\n                        </div>\n                      `}\n                </div>\n                ${!this._showProgressBar\n                  ? \"\"\n                  : html`\n                      <paper-progress\n                        .max=${stateObj.attributes.media_duration}\n                        style=${styleMap({\n                          \"--paper-progress-active-color\":\n                            this._foregroundColor || \"var(--accent-color)\",\n                          cursor: supportsFeature(stateObj, SUPPORT_SEEK)\n                            ? \"pointer\"\n                            : \"initial\",\n                        })}\n                        @click=${this._handleSeek}\n                      ></paper-progress>\n                    `}\n              `}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected firstUpdated(): void {\n    this._attachObserver();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    if (!this._config || !this.hass || !changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const stateObj = this._stateObj;\n\n    if (!stateObj) {\n      if (this._progressInterval) {\n        clearInterval(this._progressInterval);\n        this._progressInterval = undefined;\n      }\n      this._foregroundColor = undefined;\n      this._backgroundColor = undefined;\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | MediaControlCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n\n    this._updateProgressBar();\n\n    if (\n      !this._progressInterval &&\n      this._showProgressBar &&\n      stateObj.state === \"playing\"\n    ) {\n      this._progressInterval = window.setInterval(\n        () => this._updateProgressBar(),\n        1000\n      );\n    } else if (\n      this._progressInterval &&\n      (!this._showProgressBar || stateObj.state !== \"playing\")\n    ) {\n      clearInterval(this._progressInterval);\n      this._progressInterval = undefined;\n    }\n\n    const oldImage =\n      oldHass?.states[this._config.entity]?.attributes.entity_picture_local ||\n      oldHass?.states[this._config.entity]?.attributes.entity_picture;\n\n    if (!this._image) {\n      this._foregroundColor = undefined;\n      this._backgroundColor = undefined;\n      return;\n    }\n\n    if (this._image !== oldImage) {\n      this._setColors();\n    }\n  }\n\n  private _getControls(): ControlButton[] | undefined {\n    const stateObj = this._stateObj;\n\n    if (!stateObj) {\n      return undefined;\n    }\n\n    const state = stateObj.state;\n\n    if (UNAVAILABLE_STATES.includes(state)) {\n      return undefined;\n    }\n\n    if (state === \"off\") {\n      return supportsFeature(stateObj, SUPPORT_TURN_ON)\n        ? [\n            {\n              icon: \"hass:power\",\n              action: \"turn_on\",\n            },\n          ]\n        : undefined;\n    }\n\n    if (state === \"on\") {\n      return supportsFeature(stateObj, SUPPORT_TURN_OFF)\n        ? [\n            {\n              icon: \"hass:power\",\n              action: \"turn_off\",\n            },\n          ]\n        : undefined;\n    }\n\n    if (state === \"idle\") {\n      return supportsFeature(stateObj, SUPPORTS_PLAY)\n        ? [\n            {\n              icon: \"hass:play\",\n              action: \"media_play\",\n            },\n          ]\n        : undefined;\n    }\n\n    const buttons: ControlButton[] = [];\n\n    if (supportsFeature(stateObj, SUPPORT_PREVIOUS_TRACK)) {\n      buttons.push({\n        icon: \"hass:skip-previous\",\n        action: \"media_previous_track\",\n      });\n    }\n\n    if (\n      (state === \"playing\" &&\n        (supportsFeature(stateObj, SUPPORT_PAUSE) ||\n          supportsFeature(stateObj, SUPPORT_STOP))) ||\n      (state === \"paused\" && supportsFeature(stateObj, SUPPORTS_PLAY))\n    ) {\n      buttons.push({\n        icon:\n          state !== \"playing\"\n            ? \"hass:play\"\n            : supportsFeature(stateObj, SUPPORT_PAUSE)\n            ? \"hass:pause\"\n            : \"hass:stop\",\n        action: \"media_play_pause\",\n      });\n    }\n\n    if (supportsFeature(stateObj, SUPPORT_NEXT_TRACK)) {\n      buttons.push({\n        icon: \"hass:skip-next\",\n        action: \"media_next_track\",\n      });\n    }\n\n    return buttons.length > 0 ? buttons : undefined;\n  }\n\n  private get _image() {\n    if (!this.hass || !this._config) {\n      return undefined;\n    }\n\n    const stateObj = this._stateObj;\n\n    if (!stateObj) {\n      return undefined;\n    }\n\n    return (\n      stateObj.attributes.entity_picture_local ||\n      stateObj.attributes.entity_picture\n    );\n  }\n\n  private get _showProgressBar() {\n    if (!this.hass || !this._config || this._narrow) {\n      return false;\n    }\n\n    const stateObj = this._stateObj;\n\n    if (!stateObj) {\n      return false;\n    }\n\n    return (\n      (stateObj.state === \"playing\" || stateObj.state === \"paused\") &&\n      \"media_duration\" in stateObj.attributes &&\n      \"media_position\" in stateObj.attributes\n    );\n  }\n\n  private _measureCard() {\n    const card = this.shadowRoot!.querySelector(\"ha-card\");\n    if (!card) {\n      return;\n    }\n    this._narrow = card.offsetWidth < 350;\n    this._veryNarrow = card.offsetWidth < 300;\n    this._cardHeight = card.offsetHeight;\n  }\n\n  private async _attachObserver(): Promise<void> {\n    await installResizeObserver();\n    this._resizeObserver = new ResizeObserver(\n      debounce(() => this._measureCard(), 250, false)\n    );\n\n    const card = this.shadowRoot!.querySelector(\"ha-card\");\n    // If we show an error or warning there is no ha-card\n    if (!card) {\n      return;\n    }\n    this._resizeObserver.observe(card);\n  }\n\n  private _handleMoreInfo(): void {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n\n  private _handleClick(e: MouseEvent): void {\n    this.hass!.callService(\n      \"media_player\",\n      (e.currentTarget! as HTMLElement).getAttribute(\"action\")!,\n      {\n        entity_id: this._config!.entity,\n      }\n    );\n  }\n\n  private _updateProgressBar(): void {\n    if (this._progressBar) {\n      this._progressBar.value = getCurrentProgress(this._stateObj!);\n    }\n  }\n\n  private get _stateObj(): MediaEntity | undefined {\n    return this.hass!.states[this._config!.entity] as MediaEntity;\n  }\n\n  private _handleSeek(e: MouseEvent): void {\n    const stateObj = this._stateObj!;\n\n    if (!supportsFeature(stateObj, SUPPORT_SEEK)) {\n      return;\n    }\n\n    const progressWidth = (this.shadowRoot!.querySelector(\n      \"paper-progress\"\n    ) as HTMLElement).offsetWidth;\n\n    const percent = e.offsetX / progressWidth;\n    const position = (e.currentTarget! as any).max * percent;\n\n    this.hass!.callService(\"media_player\", \"media_seek\", {\n      entity_id: this._config!.entity,\n      seek_position: position,\n    });\n  }\n\n  private _setColors(): void {\n    if (!this._image) {\n      return;\n    }\n\n    new Vibrant(this._image, {\n      colorCount: 16,\n      generator: customGenerator,\n    })\n      .getPalette()\n      .then(([foreground, background]: [string, string]) => {\n        this._backgroundColor = background;\n        this._foregroundColor = foreground;\n      })\n      .catch((err: any) => {\n        // eslint-disable-next-line no-console\n        console.error(\"Error getting Image Colors\", err);\n        this._foregroundColor = undefined;\n        this._backgroundColor = undefined;\n      });\n  }\n\n  private _marqueeMouseOver(): void {\n    if (!this._marqueeActive) {\n      this._marqueeActive = true;\n    }\n  }\n\n  private _marqueeMouseLeave(): void {\n    if (this._marqueeActive) {\n      this._marqueeActive = false;\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        overflow: hidden;\n      }\n\n      .background {\n        display: flex;\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 100%;\n        width: 100%;\n        transition: filter 0.8s;\n      }\n\n      .color-block {\n        background-color: var(--primary-color);\n        transition: background-color 0.8s;\n        width: 100%;\n      }\n\n      .color-gradient {\n        position: absolute;\n        background-image: linear-gradient(\n          to right,\n          var(--primary-color),\n          transparent\n        );\n        height: 100%;\n        right: 0;\n        opacity: 1;\n        transition: width 0.8s, opacity 0.8s linear 0.8s;\n      }\n\n      .image {\n        background-color: var(--primary-color);\n        background-position: center;\n        background-size: cover;\n        background-repeat: no-repeat;\n        position: absolute;\n        right: 0;\n        height: 100%;\n        opacity: 1;\n        transition: width 0.8s, background-image 0.8s, background-color 0.8s,\n          background-size 0.8s, opacity 0.8s linear 0.8s;\n      }\n\n      .no-image .image {\n        opacity: 0;\n      }\n\n      .no-img {\n        background-color: var(--primary-color);\n        background-size: initial;\n        background-repeat: no-repeat;\n        background-position: center center;\n        padding-bottom: 0;\n        position: absolute;\n        right: 0;\n        height: 100%;\n        background-image: url(\"../static/images/card_media_player_bg.png\");\n        width: 50%;\n        transition: opacity 0.8s, background-color 0.8s;\n      }\n\n      .off .image,\n      .off .color-gradient {\n        opacity: 0;\n        transition: opacity 0s, width 0.8s;\n        width: 0;\n      }\n\n      .unavailable .no-img,\n      .background:not(.off):not(.no-image) .no-img {\n        opacity: 0;\n      }\n\n      .player {\n        position: relative;\n        padding: 16px;\n        color: var(--text-primary-color);\n        transition-property: color, padding;\n        transition-duration: 0.4s;\n      }\n\n      .icon {\n        width: 18px;\n      }\n\n      .controls {\n        padding: 8px 8px 8px 0;\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n        transition: padding, color;\n        transition-duration: 0.4s;\n        margin-left: -12px;\n      }\n\n      .controls > div {\n        display: flex;\n        align-items: center;\n      }\n\n      .controls ha-icon-button {\n        --mdc-icon-button-size: 44px;\n        --mdc-icon-size: 22px;\n      }\n\n      ha-icon-button[action=\"media_play\"],\n      ha-icon-button[action=\"media_play_pause\"],\n      ha-icon-button[action=\"turn_on\"],\n      ha-icon-button[action=\"turn_off\"] {\n        --mdc-icon-button-size: 56px;\n        --mdc-icon-size: 28px;\n      }\n\n      .top-info {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .icon-name {\n        display: flex;\n        height: fit-content;\n        align-items: center;\n      }\n\n      .icon-name ha-icon {\n        padding-right: 8px;\n      }\n\n      .more-info {\n        position: absolute;\n        top: 8px;\n        right: 0px;\n      }\n\n      .media-info {\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        overflow: hidden;\n      }\n\n      hui-marquee {\n        font-size: 1.2em;\n        margin: 0px 0 4px;\n      }\n\n      .title-controls {\n        padding-top: 16px;\n      }\n\n      paper-progress {\n        width: 100%;\n        height: var(--paper-progress-height, 4px);\n        margin-top: 4px;\n        border-radius: calc(var(--paper-progress-height, 4px) / 2);\n        --paper-progress-container-color: rgba(200, 200, 200, 0.5);\n      }\n\n      .no-image .controls {\n        padding: 0;\n      }\n\n      .off.background {\n        filter: grayscale(1);\n      }\n\n      .narrow .controls,\n      .no-progress .controls {\n        padding-bottom: 0;\n      }\n\n      .narrow ha-icon-button {\n        --mdc-icon-button-size: 40px;\n        --mdc-icon-size: 20px;\n      }\n\n      .narrow ha-icon-button[action=\"media_play\"],\n      .narrow ha-icon-button[action=\"media_play_pause\"],\n      .narrow ha-icon-button[action=\"turn_on\"] {\n        --mdc-icon-button-size: 50px;\n        --mdc-icon-size: 25px;\n      }\n\n      .no-progress.player:not(.no-controls) {\n        padding-bottom: 0px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-media-control-card\": HuiMediaControlCard;\n  }\n}\n"],"sourceRoot":""}