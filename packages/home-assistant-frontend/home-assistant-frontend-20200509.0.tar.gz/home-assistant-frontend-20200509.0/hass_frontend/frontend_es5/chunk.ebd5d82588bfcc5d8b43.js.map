{"version":3,"sources":["webpack:///./src/common/navigate.ts","webpack:///./src/common/util/render-status.ts","webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/data/zone.ts","webpack:///./src/data/core.ts","webpack:///./src/components/map/ha-location-editor.ts","webpack:///./src/components/timezone-datalist.ts","webpack:///./src/onboarding/onboarding-core-config.ts","webpack:///./node_modules/@polymer/iron-behaviors/iron-button-state.js"],"names":["__webpack_require__","d","__webpack_exports__","navigate","_dom_fire_event__WEBPACK_IMPORTED_MODULE_0__","_node","path","replace","arguments","length","undefined","history","replaceState","pushState","fireEvent","window","afterNextRender","nextRender","cb","requestAnimationFrame","setTimeout","Promise","resolve","setupLeafletMap","_ref","regeneratorRuntime","mark","_callee","mapElement","darkMode","draw","Leaflet","map","style","_args","wrap","_context","prev","next","parentNode","Error","e","then","t","bind","sent","Icon","Default","imagePath","document","createElement","setAttribute","appendChild","setView","createTileLayer","addTo","abrupt","stop","_x","apply","this","leaflet","tileLayer","concat","Browser","retina","attribution","subdomains","minZoom","maxZoom","defaultRadiusColor","homeRadiusColor","passiveRadiusColor","fetchZones","createZone","updateZone","deleteZone","showZoneEditor","getZoneEditorInitData","inititialZoneEditorData","_common_navigate__WEBPACK_IMPORTED_MODULE_0__","hass","callWS","type","values","Object","assign","zoneId","updates","zone_id","el","data","saveCoreConfig","detectCoreConfig","customElement","LocationEditor","property","_leafletMap","location","_locationMarker","getBounds","fitBounds","fitZoom","_ignoreFitToMap","html","_templateObject","changedProps","_get","_getPrototypeOf","prototype","call","_initMap","has","_updateMarker","fitMap","_updateRadius","_updateRadiusColor","_updateIcon","shadowRoot","querySelector","_yield$setupLeafletMa","_yield$setupLeafletMa2","_this2","_mapEl","Boolean","radius","_slicedToArray","addEventListener","ev","_locationUpdated","latlng","invalidateSize","longitude","lng","Math","abs","lat","bubbles","getRadius","icon","iconHTML","outerHTML","_iconEl","divIcon","iconSize","className","_setIcon","editing","_moveMarker","setIcon","_this3","enable","moveMarker","resizeMarker","_resizeMarkers","target","getLatLng","_radiusUpdated","_callee2","_this4","_context2","remove","setLatLng","disable","_setupEdit","circle","color","radiusColor","addLayer","marker","draggable","setRadius","setStyle","css","_templateObject2","LitElement","createTimezoneListEl","google_timezones_json__WEBPACK_IMPORTED_MODULE_0__","google_timezones_json__WEBPACK_IMPORTED_MODULE_0___default","n","list","id","keys","timezones","forEach","key","option","value","innerHTML","amsterdam","OnboardingCoreConfig","onboardingLocalize","user","name","_working","_nameValue","_handleChange","_detect","_locationValue","_locationChanged","localize","_timeZoneValue","_elevationValue","_unitSystemValue","_unitSystemChanged","_save","focus","keyCode","inputElement","_name","_location","_elevation","_timeZone","_unitSystem","currentTarget","detail","latitude","Number","elevation","String","unit_system","time_zone","t0","alert","message","finish","result","preventDefault","location_name","onboardCoreConfigStep","IronButtonStateImpl","IronButtonState","_polymer_iron_a11y_keys_behavior_iron_a11y_keys_behavior_js__WEBPACK_IMPORTED_MODULE_2__","_polymer_polymer_lib_legacy_polymer_dom_js__WEBPACK_IMPORTED_MODULE_3__","properties","pressed","readOnly","reflectToAttribute","observer","toggles","active","notify","pointerDown","receivedFocusFromKeyboard","ariaActiveAttribute","listeners","down","up","tap","observers","keyBindings","enter:keydown","space:keydown","space:keyup","_mouseEventRe","_tapHandler","_userActivate","_focusChanged","focused","_detectKeyboardFocus","_setPressed","_setReceivedFocusFromKeyboard","fire","_downHandler","event","_setPointerDown","_upHandler","_spaceKeyDownHandler","keyboardEvent","dom","localTarget","isLightDescendant","stopImmediatePropagation","_spaceKeyUpHandler","_asyncClick","async","click","_pressedChanged","_changedButtonState","_ariaActiveAttributeChanged","oldValue","hasAttribute","removeAttribute","_activeChanged","_controlStateChanged","disabled","_buttonStateChanged","IronA11yKeysBehavior"],"mappings":"uFAAAA,EAAAC,EAAAC,EAAA,sBAAAC,IAAA,IAAAC,EAAAJ,EAAA,IAWaG,EAAW,SAACE,EAAYC,GAAkC,IAApBC,EAAoBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAO1DD,EACTI,QAAQC,aAAa,KAAM,GAAIN,GAE/BK,QAAQE,UAAU,KAAM,GAAIP,GAE9BQ,YAAUC,OAAQ,mBAAoB,CACpCR,+CCxBJP,EAAAC,EAAAC,EAAA,sBAAAc,IAAAhB,EAAAC,EAAAC,EAAA,sBAAAe,IAAO,IAAMD,EAAkB,SAACE,GAC9BC,sBAAsB,kBAAMC,WAAWF,EAAI,MAGhCD,EAAa,WACxB,OAAO,IAAII,QAAQ,SAACC,GAClBN,EAAgBM,iOCAb,IAAMC,EAAe,iBAAAC,KAAAC,mBAAAC,KAAG,SAAAC,EAC7BC,GAD6B,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA1B,UAAA,OAAAiB,mBAAAU,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,UAE7BT,EAF6BK,EAAAzB,OAAA,QAAAC,IAAAwB,EAAA,IAAAA,EAAA,GAG7BJ,EAH6BI,EAAAzB,OAAA,QAAAC,IAAAwB,EAAA,IAAAA,EAAA,GAKxBN,EAAWW,WALa,CAAAH,EAAAE,KAAA,cAMrB,IAAIE,MAAM,oDANW,cAAAJ,EAAAE,KAAA,EASLtC,EAAAyC,EAAA,KAAAC,KAAA1C,EAAA2C,EAAAC,KAAA,aATK,WASvBb,EATuBK,EAAAS,KAAA,SAYrBC,KAAKC,QAAQC,UAAY,kCAE7BlB,EAdyB,CAAAM,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,GAerBtC,EAAAyC,EAAA,KAAAC,KAAA1C,EAAA2C,EAAAC,KAAA,aAfqB,eAkBvBZ,EAAMD,EAAQC,IAAIJ,IAClBK,EAAQgB,SAASC,cAAc,SAC/BC,aAAa,OAAQ,sCAC3BlB,EAAMkB,aAAa,MAAO,cAC1BvB,EAAWW,WAAWa,YAAYnB,GAClCD,EAAIqB,QAAQ,CAAC,WAAY,WAAY,IACrCC,EAAgBvB,EAASF,GAAU0B,MAAMvB,GAxBZI,EAAAoB,OAAA,SA0BtB,CAACxB,EAAKD,IA1BgB,yBAAAK,EAAAqB,SAAA9B,kLAAH,gBAAA+B,GAAA,OAAAlC,EAAAmC,MAAAC,KAAApD,YAAA,GA6Bf8C,EAAkB,SAC7BO,EACAhC,GAEA,OAAOgC,EAAQC,UAAR,qCAAAC,OAEHlC,EAAW,WAAa,YAFrB,gBAAAkC,OAGUF,EAAQG,QAAQC,OAAS,UAAY,QACpD,CACEC,YACE,wIACFC,WAAY,OACZC,QAAS,EACTC,QAAS,wCChDfrE,EAAAC,EAAAC,EAAA,sBAAAoE,IAAAtE,EAAAC,EAAAC,EAAA,sBAAAqE,IAAAvE,EAAAC,EAAAC,EAAA,sBAAAsE,IAAAxE,EAAAC,EAAAC,EAAA,sBAAAuE,IAAAzE,EAAAC,EAAAC,EAAA,sBAAAwE,IAAA1E,EAAAC,EAAAC,EAAA,sBAAAyE,IAAA3E,EAAAC,EAAAC,EAAA,sBAAA0E,IAAA5E,EAAAC,EAAAC,EAAA,sBAAA2E,IAAA7E,EAAAC,EAAAC,EAAA,sBAAA4E,IAAA,IAoDIC,EApDJC,EAAAhF,EAAA,KAGasE,EAAqB,UACrBC,EAAkB,UAClBC,EAAqB,UAqBrBC,EAAa,SAACQ,GAAD,OACxBA,EAAKC,OAAe,CAAEC,KAAM,eAEjBT,EAAa,SAACO,EAAqBG,GAAtB,OACxBH,EAAKC,OAALG,OAAAC,OAAA,CACEH,KAAM,eACHC,KAGMT,EAAa,SACxBM,EACAM,EACAC,GAHwB,OAKxBP,EAAKC,OAALG,OAAAC,OAAA,CACEH,KAAM,cACNM,QAASF,GACNC,KAGMZ,EAAa,SAACK,EAAqBM,GAAtB,OACxBN,EAAKC,OAAO,CACVC,KAAM,cACNM,QAASF,KAKAV,EAAiB,SAC5Ba,EACAC,GAEAZ,EAA0BY,EAC1BxF,YAASuF,EAAI,qBAGFZ,EAAwB,WACnC,IAAMa,EAAOZ,EAEb,OADAA,OAA0BrE,EACnBiF,qCCnDT3F,EAAAC,EAAAC,EAAA,sBAAA0F,IAAA5F,EAAAC,EAAAC,EAAA,sBAAA2F,IAAO,IAAMD,EAAiB,SAC5BX,EACAG,GAF4B,OAI5BH,EAAKC,OAALG,OAAAC,OAAA,CACEH,KAAM,sBACHC,KAGMS,EAAmB,SAACZ,GAAD,OAC9BA,EAAKC,OAAoC,CACvCC,KAAM,6pUCETW,YAAc,yCACTC,2iBACHC,sEAEAA,oEAEAA,yEAEAA,4FAEgB,6QAajB,WACOpC,KAAKqC,aAAgBrC,KAAKsC,WAG1BtC,KAAKuC,gBAA2BC,UACnCxC,KAAKqC,YAAYI,UAAWzC,KAAKuC,gBAA2BC,aAE5DxC,KAAKqC,YAAY5C,QAAQO,KAAKsC,SAAUtC,KAAK0C,SAE/C1C,KAAK2C,gBAAkB3C,KAAKsC,8CAG9B,WACE,OAAOM,YAAPC,+CAGF,SAAuBC,GACrBC,EAAAC,EAvCEb,EAuCFc,WAAA,eAAAjD,MAAAkD,KAAAlD,KAAmB8C,GACnB9C,KAAKmD,gDAGP,SAAkBL,GAChBC,EAAAC,EA5CEb,EA4CFc,WAAA,UAAAjD,MAAAkD,KAAAlD,KAAc8C,GAGT9C,KAAK7B,UAIN2E,EAAaM,IAAI,cACnBpD,KAAKqD,iBAEHrD,KAAKsC,UACHtC,KAAK2C,iBACL3C,KAAK2C,gBAAgB,KAAO3C,KAAKsC,SAAS,IAC1CtC,KAAK2C,gBAAgB,KAAO3C,KAAKsC,SAAS,IAE5CtC,KAAKsD,UAGLR,EAAaM,IAAI,WACnBpD,KAAKuD,gBAEHT,EAAaM,IAAI,gBACnBpD,KAAKwD,qBAEHV,EAAaM,IAAI,SACnBpD,KAAKyD,gDAIT,WACE,OAAOzD,KAAK0D,WAAYC,cAAc,wFAGxC,SAAA5F,IAAA,IAAA6F,EAAAC,EAAAC,EAAA9D,KAAA,OAAAnC,mBAAAU,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAC2Cf,YACvCqC,KAAK+D,QACL,EACAC,QAAQhE,KAAKiE,SAJjB,OAAAL,EAAApF,EAAAS,KAAA4E,EAAAK,EAAAN,EAAA,GACG5D,KAAKqC,YADRwB,EAAA,GACqB7D,KAAK7B,QAD1B0F,EAAA,GAME7D,KAAKqC,YAAY8B,iBACf,QAEA,SAACC,GAAD,OAA2BN,EAAKO,iBAAiBD,EAAGE,UAEtDtE,KAAKyD,cACLzD,KAAKqD,gBACLrD,KAAKsD,SACLtD,KAAKqC,YAAYkC,iBAdnB,yBAAA/F,EAAAqB,SAAA9B,EAAAiC,2GAiBA,SAAyBsE,GACvB,IAAIE,EAAYF,EAAOG,IACnBC,KAAKC,IAAIH,GAAa,MAExBA,GAAeA,EAAY,IAAS,KAAS,IAAS,KAExDxE,KAAKsC,SAAWtC,KAAK2C,gBAAkB,CAAC2B,EAAOM,IAAKJ,GACpDtH,YAAU8C,KAAM,cAAUlD,EAAW,CAAE+H,SAAS,gDAGlD,WACE7E,KAAK2C,gBAAkB3C,KAAKsC,SAC5BtC,KAAKiE,OAAUjE,KAAKuC,gBAA2BuC,YAC/C5H,YAAU8C,KAAM,cAAUlD,EAAW,CAAE+H,SAAS,6CAGlD,WACE,GAAK7E,KAAK+E,KAAV,CAMA,IAAIC,EACElD,EAAKzC,SAASC,cAAc,WAClCwC,EAAGvC,aAAa,OAAQS,KAAK+E,MAC7BC,EAAWlD,EAAGmD,UAEdjF,KAAKkF,QAAUlF,KAAK7B,QAASgH,QAAQ,CACnCvC,KAAMoC,EACNI,SAAU,CAAC,GAAI,IACfC,UAAW,4BAEbrF,KAAKsF,gBAfHtF,KAAKkF,aAAUpI,wCAkBnB,WACOkD,KAAKuC,iBAAoBvC,KAAKkF,UAI9BlF,KAAKiE,OAMSjE,KAAKuC,gBAAgBgD,QAAQC,YACrCC,QAAQzF,KAAKkF,SANrBlF,KAAKuC,gBAA2BkD,QAAQzF,KAAKkF,kDASlD,WAAqB,IAAAQ,EAAA1F,KAEnBA,KAAKuC,gBAAgBgD,QAAQI,SAE7B,IAAMC,EAAa5F,KAAKuC,gBAAgBgD,QAAQC,YAE1CK,EAAe7F,KAAKuC,gBAAgBgD,QAAQO,eAAe,GACjE9F,KAAKsF,WACLM,EAAWzB,iBACT,UAEA,SAACC,GAAD,OAAsBsB,EAAKrB,iBAAiBD,EAAG2B,OAAOC,eAExDH,EAAa1B,iBACX,UAEA,SAACC,GAAD,OAAsBsB,EAAKO,eAAe7B,2FAI9C,SAAA8B,IAAA,IAAAC,EAAAnG,KAAA,OAAAnC,mBAAAU,KAAA,SAAA6H,GAAA,cAAAA,EAAA3H,KAAA2H,EAAA1H,MAAA,UACOsB,KAAKsC,SADZ,CAAA8D,EAAA1H,KAAA,eAEQsB,KAAKuC,kBACPvC,KAAKuC,gBAAgB8D,SACrBrG,KAAKuC,qBAAkBzF,GAJ7BsJ,EAAAxG,OAAA,qBASMI,KAAKuC,gBATX,CAAA6D,EAAA1H,KAAA,YAUIsB,KAAKuC,gBAAgB+D,UAAUtG,KAAKsC,WAChCtC,KAAKiE,OAXb,CAAAmC,EAAA1H,KAAA,gBAaMsB,KAAKuC,gBAAgBgD,QAAQgB,UAbnCH,EAAA1H,KAAA,EAcYrB,cAdZ,OAeM2C,KAAKwG,aAfX,eAAAJ,EAAAxG,OAAA,kBAoBOI,KAAKiE,QAYRjE,KAAKuC,gBAAkBvC,KAAK7B,QAASsI,OAAOzG,KAAKsC,SAAU,CACzDoE,MAAO1G,KAAK2G,aAAejG,IAC3BuD,OAAQjE,KAAKiE,SAEfjE,KAAKqC,YAAauE,SAAS5G,KAAKuC,iBAChCvC,KAAKwG,eAhBLxG,KAAKuC,gBAAkBvC,KAAK7B,QAAS0I,OAAO7G,KAAKsC,SAAU,CACzDwE,WAAW,IAEb9G,KAAKsF,WACLtF,KAAKuC,gBAAgB4B,iBACnB,UAEA,SAACC,GAAD,OAAsB+B,EAAK9B,iBAAiBD,EAAG2B,OAAOC,eAExDhG,KAAKqC,YAAauE,SAAS5G,KAAKuC,kBA9BpC,yBAAA6D,EAAAvG,SAAAqG,EAAAlG,wGAyCA,WACOA,KAAKuC,iBAAoBvC,KAAKiE,QAGlCjE,KAAKuC,gBAA2BwE,UAAU/G,KAAKiE,wDAGlD,WACOjE,KAAKuC,iBAAoBvC,KAAKiE,QAGlCjE,KAAKuC,gBAA2ByE,SAAS,CAAEN,MAAO1G,KAAK2G,yDAG1D,WACE,OAAOM,YAAPC,UA7NyBC,uCC5B7B/K,EAAAC,EAAAC,EAAA,sBAAA8K,IAAA,IAAAC,EAAAjL,EAAA,KAAAkL,EAAAlL,EAAAmL,EAAAF,GAEaD,EAAuB,WAClC,IAAMI,EAAOnI,SAASC,cAAc,YAQpC,OAPAkI,EAAKC,GAAK,YACVhG,OAAOiG,KAAKC,KAAWC,QAAQ,SAACC,GAC9B,IAAMC,EAASzI,SAASC,cAAc,UACtCwI,EAAOC,MAAQF,EACfC,EAAOE,UAAYL,IAAUE,GAC7BL,EAAKhI,YAAYsI,KAEZN,opLCgBT,IAAMS,EAAY,CAAC,WAAY,2qMAE9B/F,YAAc,6CACTgG,2iBACH9F,kEAEAA,gFAEAA,sDAA8B,8BAE9BA,mEAEAA,uEAEAA,wEAEAA,yEAEAA,+EAED,WACE,OAAOQ,YAAPC,IAEM7C,KAAKmI,mBACL,6CACA,OACAnI,KAAKqB,KAAK+G,KAAMC,MAKTrI,KAAKmI,mBACZ,sDAGUnI,KAAKsI,SACRtI,KAAKuI,WACGvI,KAAKwI,cAKlBxI,KAAKmI,mBACL,uDAMEnI,KAAKmI,mBACL,8DAGiBnI,KAAKyI,QACtBzI,KAAKmI,mBACL,sDASQnI,KAAK0I,eACN,GACD1I,KAAK2I,iBAON3I,KAAKqB,KAAKuH,SACjB,2DAIU5I,KAAKsI,SACRtI,KAAK6I,eACG7I,KAAKwI,cAKbxI,KAAKqB,KAAKuH,SACjB,2DAIU5I,KAAKsI,SACRtI,KAAK8I,gBACG9I,KAAKwI,cAGlBxI,KAAKqB,KAAKuH,SACV,kEAQF5I,KAAKqB,KAAKuH,SACV,6DAKU5I,KAAK+I,iBACG/I,KAAKgJ,mBAEqBhJ,KAAKsI,SAC/CtI,KAAKqB,KAAKuH,SACV,oEAGE5I,KAAKqB,KAAKuH,SACV,gEAI0C5I,KAAKsI,SACjDtI,KAAKqB,KAAKuH,SACV,sEAGE5I,KAAKqB,KAAKuH,SACV,kEAQa5I,KAAKiJ,MAAmBjJ,KAAKsI,SAC9CtI,KAAKmI,mBACL,0FAOV,SAAuBrF,GAAc,IAAAgB,EAAA9D,KACnC+C,EAAAC,EAhJEkF,EAgJFjF,WAAA,eAAAjD,MAAAkD,KAAAlD,KAAmB8C,GACnBtF,WACE,kBAAMsG,EAAKJ,WAAYC,cAAc,eAAgBuF,SACrD,KAEFlJ,KAAKmE,iBAAiB,WAAY,SAACC,GACd,KAAfA,EAAG+E,SACLrF,EAAKmF,MAAM7E,KAGDpE,KAAK0D,WAAYC,cAC7B,mBAEIyF,aAAa5J,YAAY4H,oDAGjC,WACE,YAAsBtK,IAAfkD,KAAKqJ,MACRrJ,KAAKqJ,MACLrJ,KAAKmI,mBACH,uGAIR,WACE,OAAOnI,KAAKsJ,WAAarB,4CAG3B,WACE,YAA2BnL,IAApBkD,KAAKuJ,WAA2BvJ,KAAKuJ,WAAa,2CAG3D,WACE,OAAOvJ,KAAKwJ,qDAGd,WACE,YAA4B1M,IAArBkD,KAAKyJ,YAA4BzJ,KAAKyJ,YAAc,oDAG7D,SAAsBrF,GACpB,IAAM2B,EAAS3B,EAAGsF,cAClB1J,KAAA,IAAAG,OAAS4F,EAAOsC,OAAUtC,EAAOgC,oDAGnC,SAAyB3D,GACvBpE,KAAKsJ,UAAYlF,EAAGsF,cAAcpH,yDAGpC,SACE8B,GAEApE,KAAKyJ,YAAcrF,EAAGuF,OAAO5B,sFAG/B,SAAAhK,IAAA,IAAAyD,EAAA,OAAA3D,mBAAAU,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACEsB,KAAKsI,UAAW,EADlB9J,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAGyBuD,YAAiBjC,KAAKqB,MAH/C,QAGUG,EAHVhD,EAAAS,MAIe2K,UAAYpI,EAAOgD,YAC5BxE,KAAKsJ,UAAY,CAACO,OAAOrI,EAAOoI,UAAWC,OAAOrI,EAAOgD,aAEvDhD,EAAOsI,YACT9J,KAAKuJ,WAAaQ,OAAOvI,EAAOsI,YAE9BtI,EAAOwI,cACThK,KAAKyJ,YAAcjI,EAAOwI,aAExBxI,EAAOyI,YACTjK,KAAKwJ,UAAYhI,EAAOyI,WAd9BzL,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAA0L,GAAA1L,EAAA,SAiBI2L,MAAK,0CAAAhK,OAA2C3B,EAAA0L,GAAIE,UAjBxD,eAAA5L,EAAAC,KAAA,GAmBIuB,KAAKsI,UAAW,EAnBpB9J,EAAA6L,OAAA,6BAAA7L,EAAAqB,SAAA9B,EAAAiC,KAAA,qJAuBA,SAAAkG,EAAoB9B,GAApB,IAAA9B,EAAAgI,EAAA,OAAAzM,mBAAAU,KAAA,SAAA6H,GAAA,cAAAA,EAAA3H,KAAA2H,EAAA1H,MAAA,cACE0F,EAAGmG,iBACHvK,KAAKsI,UAAW,EAFlBlC,EAAA3H,KAAA,EAIU6D,EAAWtC,KAAK0I,eAJ1BtC,EAAA1H,KAAA,EAKUsD,YAAehC,KAAKqB,KAAM,CAC9BmJ,cAAexK,KAAKuI,WACpBqB,SAAUtH,EAAS,GACnBkC,UAAWlC,EAAS,GACpBwH,UAAWD,OAAO7J,KAAK8I,iBACvBkB,YAAahK,KAAK+I,iBAClBkB,UAAWjK,KAAK6I,gBAAkB,QAXxC,cAAAzC,EAAA1H,KAAA,EAayB+L,YAAsBzK,KAAKqB,MAbpD,OAaUiJ,EAbVlE,EAAAnH,KAcI/B,YAAU8C,KAAM,kBAAmB,CACjCuB,KAAM,cACN+I,WAhBNlE,EAAA1H,KAAA,iBAAA0H,EAAA3H,KAAA,GAAA2H,EAAA8D,GAAA9D,EAAA,SAmBIpG,KAAKsI,UAAW,EAChB6B,MAAK,mBAAAhK,OAAoBiG,EAAA8D,GAAIE,UApBjC,yBAAAhE,EAAAvG,SAAAqG,EAAAlG,KAAA,6GAwBA,WACE,OAAOiH,YAAPC,UAvP+BC,sCC9BnC/K,EAAAC,EAAAC,EAAA,sBAAAoO,IAAAtO,EAAAC,EAAAC,EAAA,sBAAAqO,IAAAvO,EAAA,GAAAA,EAAA,QAAAwO,EAAAxO,EAAA,IAAAyO,EAAAzO,EAAA,GAoBasO,EAAsB,CAEjCI,WAAY,CAKVC,QAAS,CACPxJ,KAAMyC,QACNgH,UAAU,EACVjD,OAAO,EACPkD,oBAAoB,EACpBC,SAAU,mBAOZC,QAAS,CAAC5J,KAAMyC,QAAS+D,OAAO,EAAOkD,oBAAoB,GAK3DG,OACI,CAAC7J,KAAMyC,QAAS+D,OAAO,EAAOsD,QAAQ,EAAMJ,oBAAoB,GAOpEK,YAAa,CAAC/J,KAAMyC,QAASgH,UAAU,EAAMjD,OAAO,GAMpDwD,0BAA2B,CAAChK,KAAMyC,QAASgH,UAAU,GAMrDQ,oBAAqB,CACnBjK,KAAMwI,OACNhC,MAAO,eACPmD,SAAU,gCAIdO,UAAW,CAACC,KAAM,eAAgBC,GAAI,aAAcC,IAAK,eAEzDC,UACI,CAAC,yBAA0B,+CAK/BC,YAAa,CACXC,gBAAiB,cACjBC,gBAAiB,uBACjBC,cAAe,sBAGjBC,cAAe,SAEfC,YAAa,WACPnM,KAAKmL,QAEPnL,KAAKoM,eAAepM,KAAKoL,QAEzBpL,KAAKoL,QAAS,GAIlBiB,cAAe,SAASC,GACtBtM,KAAKuM,qBAAqBD,GAErBA,GACHtM,KAAKwM,aAAY,IAIrBD,qBAAsB,SAASD,GAC7BtM,KAAKyM,+BAA+BzM,KAAKsL,aAAegB,IAK1DF,cAAe,SAAShB,GAClBpL,KAAKoL,SAAWA,IAClBpL,KAAKoL,OAASA,EACdpL,KAAK0M,KAAK,YAIdC,aAAc,SAASC,GACrB5M,KAAK6M,iBAAgB,GACrB7M,KAAKwM,aAAY,GACjBxM,KAAKyM,+BAA8B,IAGrCK,WAAY,WACV9M,KAAK6M,iBAAgB,GACrB7M,KAAKwM,aAAY,IAMnBO,qBAAsB,SAASH,GAC7B,IAAII,EAAgBJ,EAAMjD,OAAOqD,cAC7BjH,EAASkH,YAAID,GAAeE,YAI5BlN,KAAKmN,kBAAuCpH,KAGhDiH,EAAczC,iBACdyC,EAAcI,2BACdpN,KAAKwM,aAAY,KAMnBa,mBAAoB,SAAST,GAC3B,IAAII,EAAgBJ,EAAMjD,OAAOqD,cAC7BjH,EAASkH,YAAID,GAAeE,YAI5BlN,KAAKmN,kBAAuCpH,KAG5C/F,KAAK+K,SACP/K,KAAKsN,cAEPtN,KAAKwM,aAAY,KAKnBc,YAAa,WACXtN,KAAKuN,MAAM,WACTvN,KAAKwN,SACJ,IAKLC,gBAAiB,SAAS1C,GACxB/K,KAAK0N,uBAGPC,4BAA6B,SAAS5F,EAAO6F,GACvCA,GAAYA,GAAY7F,GAAS/H,KAAK6N,aAAaD,IACrD5N,KAAK8N,gBAAgBF,IAIzBG,eAAgB,SAAS3C,EAAQI,GAC3BxL,KAAKmL,QACPnL,KAAKT,aAAaS,KAAKwL,oBAAqBJ,EAAS,OAAS,SAE9DpL,KAAK8N,gBAAgB9N,KAAKwL,qBAE5BxL,KAAK0N,uBAGPM,qBAAsB,WAChBhO,KAAKiO,SACPjO,KAAKwM,aAAY,GAEjBxM,KAAK0N,uBAMTA,oBAAqB,WACf1N,KAAKkO,qBACPlO,KAAKkO,wBAOEvD,EAAkB,CAACwD,IAAsBzD","file":"chunk.ebd5d82588bfcc5d8b43.js","sourcesContent":["import { fireEvent } from \"./dom/fire_event\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"location-changed\": {\n      replace: boolean;\n    };\n  }\n}\n\nexport const navigate = (_node: any, path: string, replace = false) => {\n  if (__DEMO__) {\n    if (replace) {\n      history.replaceState(null, \"\", `${location.pathname}#${path}`);\n    } else {\n      window.location.hash = path;\n    }\n  } else if (replace) {\n    history.replaceState(null, \"\", path);\n  } else {\n    history.pushState(null, \"\", path);\n  }\n  fireEvent(window, \"location-changed\", {\n    replace,\n  });\n};\n","export const afterNextRender = (cb: () => void): void => {\n  requestAnimationFrame(() => setTimeout(cb, 0));\n};\n\nexport const nextRender = () => {\n  return new Promise((resolve) => {\n    afterNextRender(resolve);\n  });\n};\n","import type { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\nexport type LeafletDrawModuleType = typeof import(\"leaflet-draw\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement,\n  darkMode = false,\n  draw = false\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // eslint-disable-next-line\n  const Leaflet = ((await import(\n    /* webpackChunkName: \"leaflet\" */ \"leaflet\"\n  )) as any).default as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  if (draw) {\n    await import(/* webpackChunkName: \"leaflet-draw\" */ \"leaflet-draw\");\n  }\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  createTileLayer(Leaflet, darkMode).addTo(map);\n\n  return [map, Leaflet];\n};\n\nexport const createTileLayer = (\n  leaflet: LeafletModuleType,\n  darkMode: boolean\n) => {\n  return leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/${\n      darkMode ? \"dark_all\" : \"light_all\"\n    }/{z}/{x}/{y}${leaflet.Browser.retina ? \"@2x.png\" : \".png\"}`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  );\n};\n","import { navigate } from \"../common/navigate\";\nimport { HomeAssistant } from \"../types\";\n\nexport const defaultRadiusColor = \"#FF9800\";\nexport const homeRadiusColor = \"#03a9f4\";\nexport const passiveRadiusColor = \"#9b9b9b\";\n\nexport interface Zone {\n  id: string;\n  name: string;\n  icon?: string;\n  latitude: number;\n  longitude: number;\n  passive?: boolean;\n  radius?: number;\n}\n\nexport interface ZoneMutableParams {\n  icon: string;\n  latitude: number;\n  longitude: number;\n  name: string;\n  passive: boolean;\n  radius: number;\n}\n\nexport const fetchZones = (hass: HomeAssistant) =>\n  hass.callWS<Zone[]>({ type: \"zone/list\" });\n\nexport const createZone = (hass: HomeAssistant, values: ZoneMutableParams) =>\n  hass.callWS<Zone>({\n    type: \"zone/create\",\n    ...values,\n  });\n\nexport const updateZone = (\n  hass: HomeAssistant,\n  zoneId: string,\n  updates: Partial<ZoneMutableParams>\n) =>\n  hass.callWS<Zone>({\n    type: \"zone/update\",\n    zone_id: zoneId,\n    ...updates,\n  });\n\nexport const deleteZone = (hass: HomeAssistant, zoneId: string) =>\n  hass.callWS({\n    type: \"zone/delete\",\n    zone_id: zoneId,\n  });\n\nlet inititialZoneEditorData: Partial<ZoneMutableParams> | undefined;\n\nexport const showZoneEditor = (\n  el: HTMLElement,\n  data?: Partial<ZoneMutableParams>\n) => {\n  inititialZoneEditorData = data;\n  navigate(el, \"/config/zone/new\");\n};\n\nexport const getZoneEditorInitData = () => {\n  const data = inititialZoneEditorData;\n  inititialZoneEditorData = undefined;\n  return data;\n};\n","import { HassConfig } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\n\nexport interface ConfigUpdateValues {\n  location_name: string;\n  latitude: number;\n  longitude: number;\n  elevation: number;\n  unit_system: \"metric\" | \"imperial\";\n  time_zone: string;\n  external_url?: string | null;\n  internal_url?: string | null;\n}\n\nexport const saveCoreConfig = (\n  hass: HomeAssistant,\n  values: Partial<ConfigUpdateValues>\n) =>\n  hass.callWS<HassConfig>({\n    type: \"config/core/update\",\n    ...values,\n  });\n\nexport const detectCoreConfig = (hass: HomeAssistant) =>\n  hass.callWS<Partial<ConfigUpdateValues>>({\n    type: \"config/core/detect\",\n  });\n","import {\n  Circle,\n  DivIcon,\n  DragEndEvent,\n  LatLng,\n  LeafletMouseEvent,\n  Map,\n  Marker,\n} from \"leaflet\";\nimport {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  PropertyValues,\n  TemplateResult,\n} from \"lit-element\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport {\n  LeafletModuleType,\n  setupLeafletMap,\n} from \"../../common/dom/setup-leaflet-map\";\nimport { nextRender } from \"../../common/util/render-status\";\nimport { defaultRadiusColor } from \"../../data/zone\";\n\n@customElement(\"ha-location-editor\")\nclass LocationEditor extends LitElement {\n  @property() public location?: [number, number];\n\n  @property() public radius?: number;\n\n  @property() public radiusColor?: string;\n\n  @property() public icon?: string;\n\n  public fitZoom = 16;\n\n  private _iconEl?: DivIcon;\n\n  private _ignoreFitToMap?: [number, number];\n\n  // eslint-disable-next-line\n  private Leaflet?: LeafletModuleType;\n\n  private _leafletMap?: Map;\n\n  private _locationMarker?: Marker | Circle;\n\n  public fitMap(): void {\n    if (!this._leafletMap || !this.location) {\n      return;\n    }\n    if ((this._locationMarker as Circle).getBounds) {\n      this._leafletMap.fitBounds((this._locationMarker as Circle).getBounds());\n    } else {\n      this._leafletMap.setView(this.location, this.fitZoom);\n    }\n    this._ignoreFitToMap = this.location;\n  }\n\n  protected render(): TemplateResult {\n    return html` <div id=\"map\"></div> `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this._initMap();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    // Still loading.\n    if (!this.Leaflet) {\n      return;\n    }\n\n    if (changedProps.has(\"location\")) {\n      this._updateMarker();\n      if (\n        this.location &&\n        (!this._ignoreFitToMap ||\n          this._ignoreFitToMap[0] !== this.location[0] ||\n          this._ignoreFitToMap[1] !== this.location[1])\n      ) {\n        this.fitMap();\n      }\n    }\n    if (changedProps.has(\"radius\")) {\n      this._updateRadius();\n    }\n    if (changedProps.has(\"radiusColor\")) {\n      this._updateRadiusColor();\n    }\n    if (changedProps.has(\"icon\")) {\n      this._updateIcon();\n    }\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.querySelector(\"div\")!;\n  }\n\n  private async _initMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(\n      this._mapEl,\n      false,\n      Boolean(this.radius)\n    );\n    this._leafletMap.addEventListener(\n      \"click\",\n      // @ts-ignore\n      (ev: LeafletMouseEvent) => this._locationUpdated(ev.latlng)\n    );\n    this._updateIcon();\n    this._updateMarker();\n    this.fitMap();\n    this._leafletMap.invalidateSize();\n  }\n\n  private _locationUpdated(latlng: LatLng) {\n    let longitude = latlng.lng;\n    if (Math.abs(longitude) > 180.0) {\n      // Normalize longitude if map provides values beyond -180 to +180 degrees.\n      longitude = (((longitude % 360.0) + 540.0) % 360.0) - 180.0;\n    }\n    this.location = this._ignoreFitToMap = [latlng.lat, longitude];\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _radiusUpdated() {\n    this._ignoreFitToMap = this.location;\n    this.radius = (this._locationMarker as Circle).getRadius();\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _updateIcon() {\n    if (!this.icon) {\n      this._iconEl = undefined;\n      return;\n    }\n\n    // create icon\n    let iconHTML = \"\";\n    const el = document.createElement(\"ha-icon\");\n    el.setAttribute(\"icon\", this.icon);\n    iconHTML = el.outerHTML;\n\n    this._iconEl = this.Leaflet!.divIcon({\n      html: iconHTML,\n      iconSize: [24, 24],\n      className: \"light leaflet-edit-move\",\n    });\n    this._setIcon();\n  }\n\n  private _setIcon() {\n    if (!this._locationMarker || !this._iconEl) {\n      return;\n    }\n\n    if (!this.radius) {\n      (this._locationMarker as Marker).setIcon(this._iconEl);\n      return;\n    }\n\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    moveMarker.setIcon(this._iconEl);\n  }\n\n  private _setupEdit() {\n    // @ts-ignore\n    this._locationMarker.editing.enable();\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    // @ts-ignore\n    const resizeMarker = this._locationMarker.editing._resizeMarkers[0];\n    this._setIcon();\n    moveMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n    );\n    resizeMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._radiusUpdated(ev)\n    );\n  }\n\n  private async _updateMarker(): Promise<void> {\n    if (!this.location) {\n      if (this._locationMarker) {\n        this._locationMarker.remove();\n        this._locationMarker = undefined;\n      }\n      return;\n    }\n\n    if (this._locationMarker) {\n      this._locationMarker.setLatLng(this.location);\n      if (this.radius) {\n        // @ts-ignore\n        this._locationMarker.editing.disable();\n        await nextRender();\n        this._setupEdit();\n      }\n      return;\n    }\n\n    if (!this.radius) {\n      this._locationMarker = this.Leaflet!.marker(this.location, {\n        draggable: true,\n      });\n      this._setIcon();\n      this._locationMarker.addEventListener(\n        \"dragend\",\n        // @ts-ignore\n        (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n      );\n      this._leafletMap!.addLayer(this._locationMarker);\n    } else {\n      this._locationMarker = this.Leaflet!.circle(this.location, {\n        color: this.radiusColor || defaultRadiusColor,\n        radius: this.radius,\n      });\n      this._leafletMap!.addLayer(this._locationMarker);\n      this._setupEdit();\n    }\n  }\n\n  private _updateRadius(): void {\n    if (!this._locationMarker || !this.radius) {\n      return;\n    }\n    (this._locationMarker as Circle).setRadius(this.radius);\n  }\n\n  private _updateRadiusColor(): void {\n    if (!this._locationMarker || !this.radius) {\n      return;\n    }\n    (this._locationMarker as Circle).setStyle({ color: this.radiusColor });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        height: 300px;\n      }\n      #map {\n        height: 100%;\n      }\n      .light {\n        color: #000000;\n      }\n      .leaflet-edit-move {\n        border-radius: 50%;\n        cursor: move !important;\n      }\n      .leaflet-edit-resize {\n        border-radius: 50%;\n        cursor: nesw-resize !important;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-location-editor\": LocationEditor;\n  }\n}\n","import timezones from \"google-timezones-json\";\n\nexport const createTimezoneListEl = () => {\n  const list = document.createElement(\"datalist\");\n  list.id = \"timezones\";\n  Object.keys(timezones).forEach((key) => {\n    const option = document.createElement(\"option\");\n    option.value = key;\n    option.innerHTML = timezones[key];\n    list.appendChild(option);\n  });\n  return list;\n};\n","import \"@material/mwc-button/mwc-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport type { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-radio-button/paper-radio-button\";\nimport \"@polymer/paper-radio-group/paper-radio-group\";\nimport {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n} from \"lit-element\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport type { LocalizeFunc } from \"../common/translations/localize\";\nimport \"../components/map/ha-location-editor\";\nimport { createTimezoneListEl } from \"../components/timezone-datalist\";\nimport {\n  ConfigUpdateValues,\n  detectCoreConfig,\n  saveCoreConfig,\n} from \"../data/core\";\nimport { onboardCoreConfigStep } from \"../data/onboarding\";\nimport type { PolymerChangedEvent } from \"../polymer-types\";\nimport type { HomeAssistant } from \"../types\";\n\nconst amsterdam = [52.3731339, 4.8903147];\n\n@customElement(\"onboarding-core-config\")\nclass OnboardingCoreConfig extends LitElement {\n  @property() public hass!: HomeAssistant;\n\n  @property() public onboardingLocalize!: LocalizeFunc;\n\n  @property() private _working = false;\n\n  @property() private _name!: ConfigUpdateValues[\"location_name\"];\n\n  @property() private _location!: [number, number];\n\n  @property() private _elevation!: string;\n\n  @property() private _unitSystem!: ConfigUpdateValues[\"unit_system\"];\n\n  @property() private _timeZone!: string;\n\n  protected render(): TemplateResult {\n    return html`\n      <p>\n        ${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.intro\",\n          \"name\",\n          this.hass.user!.name\n        )}\n      </p>\n\n      <paper-input\n        .label=${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name\"\n        )}\n        name=\"name\"\n        .disabled=${this._working}\n        .value=${this._nameValue}\n        @value-changed=${this._handleChange}\n      ></paper-input>\n\n      <div class=\"middle-text\">\n        <p>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.intro_location\"\n          )}\n        </p>\n\n        <div class=\"row\">\n          <div>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.intro_location_detect\"\n            )}\n          </div>\n          <mwc-button @click=${this._detect}>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.button_detect\"\n            )}\n          </mwc-button>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <ha-location-editor\n          class=\"flex\"\n          .location=${this._locationValue}\n          .fitZoom=${14}\n          @change=${this._locationChanged}\n        ></ha-location-editor>\n      </div>\n\n      <div class=\"row\">\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.time_zone\"\n          )}\n          name=\"timeZone\"\n          list=\"timezones\"\n          .disabled=${this._working}\n          .value=${this._timeZoneValue}\n          @value-changed=${this._handleChange}\n        ></paper-input>\n\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.elevation\"\n          )}\n          name=\"elevation\"\n          type=\"number\"\n          .disabled=${this._working}\n          .value=${this._elevationValue}\n          @value-changed=${this._handleChange}\n        >\n          <span slot=\"suffix\">\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.elevation_meters\"\n            )}\n          </span>\n        </paper-input>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"flex\">\n          ${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.unit_system\"\n          )}\n        </div>\n        <paper-radio-group\n          class=\"flex\"\n          .selected=${this._unitSystemValue}\n          @selected-changed=${this._unitSystemChanged}\n        >\n          <paper-radio-button name=\"metric\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_metric\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.metric_example\"\n              )}\n            </div>\n          </paper-radio-button>\n          <paper-radio-button name=\"imperial\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_imperial\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.imperial_example\"\n              )}\n            </div>\n          </paper-radio-button>\n        </paper-radio-group>\n      </div>\n\n      <div class=\"footer\">\n        <mwc-button @click=${this._save} .disabled=${this._working}>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.finish\"\n          )}\n        </mwc-button>\n      </div>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    setTimeout(\n      () => this.shadowRoot!.querySelector(\"paper-input\")!.focus(),\n      100\n    );\n    this.addEventListener(\"keypress\", (ev) => {\n      if (ev.keyCode === 13) {\n        this._save(ev);\n      }\n    });\n    const input = this.shadowRoot!.querySelector(\n      \"[name=timeZone]\"\n    ) as PaperInputElement;\n    input.inputElement.appendChild(createTimezoneListEl());\n  }\n\n  private get _nameValue() {\n    return this._name !== undefined\n      ? this._name\n      : this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name_default\"\n        );\n  }\n\n  private get _locationValue() {\n    return this._location || amsterdam;\n  }\n\n  private get _elevationValue() {\n    return this._elevation !== undefined ? this._elevation : 0;\n  }\n\n  private get _timeZoneValue() {\n    return this._timeZone;\n  }\n\n  private get _unitSystemValue() {\n    return this._unitSystem !== undefined ? this._unitSystem : \"metric\";\n  }\n\n  private _handleChange(ev: PolymerChangedEvent<string>) {\n    const target = ev.currentTarget as PaperInputElement;\n    this[`_${target.name}`] = target.value;\n  }\n\n  private _locationChanged(ev) {\n    this._location = ev.currentTarget.location;\n  }\n\n  private _unitSystemChanged(\n    ev: PolymerChangedEvent<ConfigUpdateValues[\"unit_system\"]>\n  ) {\n    this._unitSystem = ev.detail.value;\n  }\n\n  private async _detect() {\n    this._working = true;\n    try {\n      const values = await detectCoreConfig(this.hass);\n      if (values.latitude && values.longitude) {\n        this._location = [Number(values.latitude), Number(values.longitude)];\n      }\n      if (values.elevation) {\n        this._elevation = String(values.elevation);\n      }\n      if (values.unit_system) {\n        this._unitSystem = values.unit_system;\n      }\n      if (values.time_zone) {\n        this._timeZone = values.time_zone;\n      }\n    } catch (err) {\n      alert(`Failed to detect location information: ${err.message}`);\n    } finally {\n      this._working = false;\n    }\n  }\n\n  private async _save(ev) {\n    ev.preventDefault();\n    this._working = true;\n    try {\n      const location = this._locationValue;\n      await saveCoreConfig(this.hass, {\n        location_name: this._nameValue,\n        latitude: location[0],\n        longitude: location[1],\n        elevation: Number(this._elevationValue),\n        unit_system: this._unitSystemValue,\n        time_zone: this._timeZoneValue || \"UTC\",\n      });\n      const result = await onboardCoreConfigStep(this.hass);\n      fireEvent(this, \"onboarding-step\", {\n        type: \"core_config\",\n        result,\n      });\n    } catch (err) {\n      this._working = false;\n      alert(`Failed to save: ${err.message}`);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .row {\n        display: flex;\n        flex-direction: row;\n        margin: 0 -8px;\n        align-items: center;\n      }\n\n      .secondary {\n        color: var(--secondary-text-color);\n      }\n\n      .flex {\n        flex: 1;\n      }\n\n      .middle-text {\n        margin: 24px 0;\n      }\n\n      .row > * {\n        margin: 0 8px;\n      }\n      .footer {\n        margin-top: 16px;\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"onboarding-core-config\": OnboardingCoreConfig;\n  }\n}\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport './iron-control-state.js';\n\nimport {IronA11yKeysBehavior} from '@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\n\n/**\n * @demo demo/index.html\n * @polymerBehavior IronButtonState\n */\nexport const IronButtonStateImpl = {\n\n  properties: {\n\n    /**\n     * If true, the user is currently holding down the button.\n     */\n    pressed: {\n      type: Boolean,\n      readOnly: true,\n      value: false,\n      reflectToAttribute: true,\n      observer: '_pressedChanged'\n    },\n\n    /**\n     * If true, the button toggles the active state with each tap or press\n     * of the spacebar.\n     */\n    toggles: {type: Boolean, value: false, reflectToAttribute: true},\n\n    /**\n     * If true, the button is a toggle and is currently in the active state.\n     */\n    active:\n        {type: Boolean, value: false, notify: true, reflectToAttribute: true},\n\n    /**\n     * True if the element is currently being pressed by a \"pointer,\" which\n     * is loosely defined as mouse or touch input (but specifically excluding\n     * keyboard input).\n     */\n    pointerDown: {type: Boolean, readOnly: true, value: false},\n\n    /**\n     * True if the input device that caused the element to receive focus\n     * was a keyboard.\n     */\n    receivedFocusFromKeyboard: {type: Boolean, readOnly: true},\n\n    /**\n     * The aria attribute to be set if the button is a toggle and in the\n     * active state.\n     */\n    ariaActiveAttribute: {\n      type: String,\n      value: 'aria-pressed',\n      observer: '_ariaActiveAttributeChanged'\n    }\n  },\n\n  listeners: {down: '_downHandler', up: '_upHandler', tap: '_tapHandler'},\n\n  observers:\n      ['_focusChanged(focused)', '_activeChanged(active, ariaActiveAttribute)'],\n\n  /**\n   * @type {!Object}\n   */\n  keyBindings: {\n    'enter:keydown': '_asyncClick',\n    'space:keydown': '_spaceKeyDownHandler',\n    'space:keyup': '_spaceKeyUpHandler',\n  },\n\n  _mouseEventRe: /^mouse/,\n\n  _tapHandler: function() {\n    if (this.toggles) {\n      // a tap is needed to toggle the active state\n      this._userActivate(!this.active);\n    } else {\n      this.active = false;\n    }\n  },\n\n  _focusChanged: function(focused) {\n    this._detectKeyboardFocus(focused);\n\n    if (!focused) {\n      this._setPressed(false);\n    }\n  },\n\n  _detectKeyboardFocus: function(focused) {\n    this._setReceivedFocusFromKeyboard(!this.pointerDown && focused);\n  },\n\n  // to emulate native checkbox, (de-)activations from a user interaction fire\n  // 'change' events\n  _userActivate: function(active) {\n    if (this.active !== active) {\n      this.active = active;\n      this.fire('change');\n    }\n  },\n\n  _downHandler: function(event) {\n    this._setPointerDown(true);\n    this._setPressed(true);\n    this._setReceivedFocusFromKeyboard(false);\n  },\n\n  _upHandler: function() {\n    this._setPointerDown(false);\n    this._setPressed(false);\n  },\n\n  /**\n   * @param {!KeyboardEvent} event .\n   */\n  _spaceKeyDownHandler: function(event) {\n    var keyboardEvent = event.detail.keyboardEvent;\n    var target = dom(keyboardEvent).localTarget;\n\n    // Ignore the event if this is coming from a focused light child, since that\n    // element will deal with it.\n    if (this.isLightDescendant(/** @type {Node} */ (target)))\n      return;\n\n    keyboardEvent.preventDefault();\n    keyboardEvent.stopImmediatePropagation();\n    this._setPressed(true);\n  },\n\n  /**\n   * @param {!KeyboardEvent} event .\n   */\n  _spaceKeyUpHandler: function(event) {\n    var keyboardEvent = event.detail.keyboardEvent;\n    var target = dom(keyboardEvent).localTarget;\n\n    // Ignore the event if this is coming from a focused light child, since that\n    // element will deal with it.\n    if (this.isLightDescendant(/** @type {Node} */ (target)))\n      return;\n\n    if (this.pressed) {\n      this._asyncClick();\n    }\n    this._setPressed(false);\n  },\n\n  // trigger click asynchronously, the asynchrony is useful to allow one\n  // event handler to unwind before triggering another event\n  _asyncClick: function() {\n    this.async(function() {\n      this.click();\n    }, 1);\n  },\n\n  // any of these changes are considered a change to button state\n\n  _pressedChanged: function(pressed) {\n    this._changedButtonState();\n  },\n\n  _ariaActiveAttributeChanged: function(value, oldValue) {\n    if (oldValue && oldValue != value && this.hasAttribute(oldValue)) {\n      this.removeAttribute(oldValue);\n    }\n  },\n\n  _activeChanged: function(active, ariaActiveAttribute) {\n    if (this.toggles) {\n      this.setAttribute(this.ariaActiveAttribute, active ? 'true' : 'false');\n    } else {\n      this.removeAttribute(this.ariaActiveAttribute);\n    }\n    this._changedButtonState();\n  },\n\n  _controlStateChanged: function() {\n    if (this.disabled) {\n      this._setPressed(false);\n    } else {\n      this._changedButtonState();\n    }\n  },\n\n  // provide hook for follow-on behaviors to react to button-state\n\n  _changedButtonState: function() {\n    if (this._buttonStateChanged) {\n      this._buttonStateChanged();  // abstract\n    }\n  }\n\n};\n\n/** @polymerBehavior */\nexport const IronButtonState = [IronA11yKeysBehavior, IronButtonStateImpl];\n"],"sourceRoot":""}