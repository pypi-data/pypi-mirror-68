{"version":3,"sources":["webpack:///./src/cast/dev_const.ts","webpack:///./src/cast/receiver_messages.ts","webpack:///./src/cast/const.ts","webpack:///./src/panels/lovelace/special-rows/hui-cast-row.ts"],"names":["__webpack_require__","d","__webpack_exports__","CAST_DEV_APP_ID","CAST_DEV_HASS_URL","castSendAuth","castSendShowLovelaceView","ensureConnectedCastSession","_const__WEBPACK_IMPORTED_MODULE_0__","_dev_const__WEBPACK_IMPORTED_MODULE_1__","cast","auth","sendMessage","type","refreshToken","data","refresh_token","clientId","hassUrl","CAST_DEV","viewPath","urlPath","castConnectedToOurHass","Promise","resolve","unsub","addEventListener","CAST_APP_ID","CAST_NS","_dev_const__WEBPACK_IMPORTED_MODULE_0__","__DEV__","customElement","HuiCastRow","property","config","undefined","view","Error","this","_config","Object","assign","icon","name","changedProperties","size","has","html","_templateObject","active","_castManager","status","lovelacePath","dashboard","_templateObject2","_noHTTPS","_templateObject3","_templateObject4","_templateObject5","castState","_templateObject6","_templateObject7","_sendLovelace","classMap","inactive","changedProps","_this2","_get","_getPrototypeOf","prototype","call","location","protocol","hostname","e","then","bind","_ref","getCastManager","hass","mgr","requestUpdate","hide_if_unavailable","style","display","_callee","regeneratorRuntime","wrap","_context","prev","next","stop","css","_templateObject8","LitElement"],"mappings":"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","file":"chunk.f9222328a6e08dd7fca4.js","sourcesContent":["// Replace this with your own unpublished cast app that points at your local dev\nexport const CAST_DEV_APP_ID = \"5FE44367\";\n\n// Chromecast SDK will only load on localhost and HTTPS\n// So during local development we have to send our dev IP address,\n// but then run the UI on localhost.\nexport const CAST_DEV_HASS_URL = \"http://192.168.1.234:8123\";\n","// Nessages to be processed inside the Cast Receiver app\n\nimport { Auth } from \"home-assistant-js-websocket\";\nimport { CastManager } from \"./cast_manager\";\nimport { CAST_DEV } from \"./const\";\nimport { CAST_DEV_HASS_URL } from \"./dev_const\";\nimport { BaseCastMessage } from \"./types\";\n\nexport interface GetStatusMessage extends BaseCastMessage {\n  type: \"get_status\";\n}\n\nexport interface ConnectMessage extends BaseCastMessage {\n  type: \"connect\";\n  refreshToken: string;\n  clientId: string | null;\n  hassUrl: string;\n}\n\nexport interface ShowLovelaceViewMessage extends BaseCastMessage {\n  type: \"show_lovelace_view\";\n  viewPath: string | number | null;\n  urlPath: string | null;\n}\n\nexport interface ShowDemoMessage extends BaseCastMessage {\n  type: \"show_demo\";\n}\n\nexport type HassMessage =\n  | ShowDemoMessage\n  | GetStatusMessage\n  | ConnectMessage\n  | ShowLovelaceViewMessage;\n\nexport const castSendAuth = (cast: CastManager, auth: Auth) =>\n  cast.sendMessage({\n    type: \"connect\",\n    refreshToken: auth.data.refresh_token,\n    clientId: auth.data.clientId,\n    hassUrl: CAST_DEV ? CAST_DEV_HASS_URL : auth.data.hassUrl,\n  });\n\nexport const castSendShowLovelaceView = (\n  cast: CastManager,\n  viewPath: ShowLovelaceViewMessage[\"viewPath\"],\n  urlPath?: string | null\n) =>\n  cast.sendMessage({\n    type: \"show_lovelace_view\",\n    viewPath,\n    urlPath: urlPath || null,\n  });\n\nexport const castSendShowDemo = (cast: CastManager) =>\n  cast.sendMessage({\n    type: \"show_demo\",\n  });\n\nexport const ensureConnectedCastSession = (cast: CastManager, auth: Auth) => {\n  if (cast.castConnectedToOurHass) {\n    return undefined;\n  }\n\n  return new Promise((resolve) => {\n    const unsub = cast.addEventListener(\"connection-changed\", () => {\n      if (cast.castConnectedToOurHass) {\n        unsub();\n        resolve();\n      }\n    });\n\n    castSendAuth(cast, auth);\n  });\n};\n","import { CAST_DEV_APP_ID } from \"./dev_const\";\n\n// Guard dev mode with `__dev__` so it can only ever be enabled in dev mode.\nexport const CAST_DEV = __DEV__ && true;\n\nexport const CAST_APP_ID = CAST_DEV ? CAST_DEV_APP_ID : \"B12CE3CA\";\nexport const CAST_NS = \"urn:x-cast:com.nabucasa.hast\";\n","import \"@material/mwc-button/mwc-button\";\nimport {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n  PropertyValues,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { CastManager } from \"../../../cast/cast_manager\";\nimport {\n  castSendShowLovelaceView,\n  ensureConnectedCastSession,\n} from \"../../../cast/receiver_messages\";\nimport \"../../../components/ha-icon\";\nimport { HomeAssistant } from \"../../../types\";\nimport { CastConfig, LovelaceRow } from \"../entity-rows/types\";\n\n@customElement(\"hui-cast-row\")\nclass HuiCastRow extends LitElement implements LovelaceRow {\n  @property() public hass!: HomeAssistant;\n\n  @property() private _config?: CastConfig;\n\n  @property() private _castManager?: CastManager | null;\n\n  @property() private _noHTTPS = false;\n\n  public setConfig(config: CastConfig): void {\n    if (!config || config.view === undefined || config.view === null) {\n      throw new Error(\"Invalid Configuration: 'view' required\");\n    }\n\n    this._config = {\n      icon: \"hass:television\",\n      name: \"Home Assistant Cast\",\n      ...config,\n    };\n  }\n\n  protected shouldUpdate(changedProperties: PropertyValues) {\n    return !(changedProperties.size === 1 && changedProperties.has(\"hass\"));\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config) {\n      return html``;\n    }\n\n    const active =\n      this._castManager &&\n      this._castManager.status &&\n      this._config.view === this._castManager.status.lovelacePath &&\n      this._config.dashboard === this._castManager.status.urlPath;\n\n    return html`\n      <ha-icon .icon=\"${this._config.icon}\"></ha-icon>\n      <div class=\"flex\">\n        <div class=\"name\">${this._config.name}</div>\n        ${this._noHTTPS\n          ? html` Cast requires HTTPS `\n          : this._castManager === undefined\n          ? html``\n          : this._castManager === null\n          ? html` Cast API unavailable `\n          : this._castManager.castState === \"NO_DEVICES_AVAILABLE\"\n          ? html` No devices found `\n          : html`\n              <div class=\"controls\">\n                <google-cast-launcher></google-cast-launcher>\n                <mwc-button\n                  @click=${this._sendLovelace}\n                  class=${classMap({ inactive: !active })}\n                  .unelevated=${active}\n                  .disabled=${!this._castManager.status}\n                >\n                  SHOW\n                </mwc-button>\n              </div>\n            `}\n      </div>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    if (location.protocol === \"http:\" && location.hostname !== \"localhost\") {\n      this._noHTTPS = true;\n    }\n    import(\"../../../cast/cast_manager\").then(({ getCastManager }) =>\n      getCastManager(this.hass.auth).then(\n        (mgr) => {\n          this._castManager = mgr;\n          mgr.addEventListener(\"connection-changed\", () => {\n            this.requestUpdate();\n          });\n          mgr.addEventListener(\"state-changed\", () => {\n            this.requestUpdate();\n          });\n        },\n        () => {\n          this._castManager = null;\n        }\n      )\n    );\n  }\n\n  protected updated(changedProps) {\n    super.updated(changedProps);\n    if (this._config && this._config.hide_if_unavailable) {\n      this.style.display =\n        !this._castManager ||\n        this._castManager.castState === \"NO_DEVICES_AVAILABLE\"\n          ? \"none\"\n          : \"\";\n    }\n  }\n\n  private async _sendLovelace() {\n    await ensureConnectedCastSession(this._castManager!, this.hass.auth);\n    castSendShowLovelaceView(\n      this._castManager!,\n      this._config!.view,\n      this._config!.dashboard\n    );\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      .flex {\n        flex: 1;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      .name {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .controls {\n        display: flex;\n        align-items: center;\n      }\n      google-cast-launcher {\n        margin-right: 0.57em;\n        cursor: pointer;\n        display: inline-block;\n        height: 24px;\n        width: 24px;\n      }\n      .inactive {\n        padding: 0 4px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-cast-row\": HuiCastRow;\n  }\n}\n"],"sourceRoot":""}